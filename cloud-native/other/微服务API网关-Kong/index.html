<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="stay hungry,stay foolish"><meta name=author content=Kaliarch><link href=https://redhatxl.github.io/cloud-native/other/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3-Kong/ rel=canonical><link href=../%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%8E%9F%E7%94%9FCCE%E5%AE%9E%E6%88%98/ rel=prev><link href=../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD10%E7%A7%8D%E5%B8%B8%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.16"><title>微服务API网关-Kong - Kaliarch Blog</title><link rel=stylesheet href=../../../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-G9D2HRH134"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-G9D2HRH134",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-G9D2HRH134",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#api-kong class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../.. title="Kaliarch Blog" class="md-header__button md-logo" aria-label="Kaliarch Blog" data-md-component=logo> <img src=../../../assets/images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kaliarch Blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 微服务API网关-Kong </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=light-blue data-md-color-accent=purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/redhatxl/redhatxl.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> redhatxl.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> 首页 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../develop/01-k8s%20%E5%BC%80%E5%8F%91%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D/ class=md-tabs__link> 云原生 </a> </li> <li class=md-tabs__item> <a href=../../../devops/Gitlab%20CI/01%E6%95%8F%E6%8D%B7%E6%97%A0%E6%95%8C%E4%B9%8B%E5%AE%9E%E6%88%98Gitlab%20CI/ class=md-tabs__link> devops </a> </li> <li class=md-tabs__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/01-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/ class=md-tabs__link> 开发技术 </a> </li> <li class=md-tabs__item> <a href=../../../linux/system/Linux%20grub%3Agrub2%E8%AF%A6%E8%A7%A3/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../other/ class=md-tabs__link> 其他 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Kaliarch Blog" class="md-nav__button md-logo" aria-label="Kaliarch Blog" data-md-component=logo> <img src=../../../assets/images/logo.png alt=logo> </a> Kaliarch Blog </label> <div class=md-nav__source> <a href=https://github.com/redhatxl/redhatxl.github.io title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> redhatxl.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> 首页 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> 云原生 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 云原生 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> 开发 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> 开发 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../develop/01-k8s%20%E5%BC%80%E5%8F%91%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D/ class=md-nav__link> <span class=md-ellipsis> 1.K8s 开发概念简介 </span> </a> </li> <li class=md-nav__item> <a href=../../develop/02-K8s%20API%20%E8%B0%83%E7%94%A8%E6%96%B9%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 2.K8s API访问方式 </span> </a> </li> <li class=md-nav__item> <a href=../../develop/03-Client-go%20%E4%BD%BF%E7%94%A8/ class=md-nav__link> <span class=md-ellipsis> 3.Client-go 的使用 </span> </a> </li> <li class=md-nav__item> <a href=../../develop/04-Cobra%20%2B%20Client-go%E5%AE%9E%E7%8E%B0K8s%E7%AE%80%E5%8D%95%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/ class=md-nav__link> <span class=md-ellipsis> 4.Cobra+Client-go实现K8s插件开发 </span> </a> </li> <li class=md-nav__item> <a href=../../develop/05-client-go%E4%B9%8BListWatcher%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 5.Client-go源码分析之ListerWatcher </span> </a> </li> <li class=md-nav__item> <a href=../../develop/06-client-go%E4%B9%8BReflector%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 6.Client-go源码分析之Reflector </span> </a> </li> <li class=md-nav__item> <a href=../../develop/07-client-go%E4%B9%8BDeltaFIFO%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 7.Client-go源码分析之DeltaFIFO </span> </a> </li> <li class=md-nav__item> <a href=../../develop/08-client-go%E4%B9%8BInformer%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 8.Client-go源码分析之Informer </span> </a> </li> <li class=md-nav__item> <a href=../../develop/09-client-go%E4%B9%8BSharedInformer%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 9.Client-go源码分析之SharedInformer </span> </a> </li> <li class=md-nav__item> <a href=../../develop/10-client-go%E4%B9%8BIndexer%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 10.Client-go源码分析之Indexer </span> </a> </li> <li class=md-nav__item> <a href=../../develop/11-client-go%E4%B9%8BWorkqueue%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> 11.Client-go源码分析之WorkQueue </span> </a> </li> <li class=md-nav__item> <a href=../../develop/12-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%9E%E7%8E%B0Controller/ class=md-nav__link> <span class=md-ellipsis> 12.自定义实现Controller </span> </a> </li> <li class=md-nav__item> <a href=../../develop/13-%E8%AE%A4%E8%AF%86CRD/ class=md-nav__link> <span class=md-ellipsis> 13.认识CRD </span> </a> </li> <li class=md-nav__item> <a href=../../develop/x-Informer%E5%AE%9E%E6%88%98%E4%B9%8B%E6%8C%81%E4%B9%85%E5%8C%96K8s%E4%BA%8B%E4%BB%B6%E8%87%B3ElasticSearch/ class=md-nav__link> <span class=md-ellipsis> x-Informer实战之持久化K8s事件至ElasticSearch </span> </a> </li> <li class=md-nav__item> <a href=../../develop/x-DeltaFIFO%E5%92%8Cindexer%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AF%B9%E6%AF%94/ class=md-nav__link> <span class=md-ellipsis> x-DeltaFIFO 与 Indexer关系 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> 运维 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> 运维 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1 id=__nav_2_2_1_label tabindex=0> <span class=md-ellipsis> 工具 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> 工具 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../operator/tools/K8s%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7%E4%B9%8BKUR8/ class=md-nav__link> <span class=md-ellipsis> K8s可视化工具之KUR8 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/K8s%E5%BF%AB%E6%8D%B7%E6%93%8D%E4%BD%9C%E5%B7%A5%E5%85%B7%E4%B9%8BK9s/ class=md-nav__link> <span class=md-ellipsis> K8s快捷操作工具之K9s </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/K8s%E8%89%B2%E5%BD%A9%E8%BE%93%E5%87%BA%E5%B7%A5%E5%85%B7%E4%B9%8Bkubecolor/ class=md-nav__link> <span class=md-ellipsis> K8s色彩输出工具之kubecolor </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/K8s%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B%E7%A5%9E%E5%99%A8%E4%B9%8Bkubetail/ class=md-nav__link> <span class=md-ellipsis> K8s日志查看利器之kubetail </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/K8s%E7%BD%91%E7%BB%9C%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7%E4%B9%8Bsniff/ class=md-nav__link> <span class=md-ellipsis> K8s 网络抓包之sniff </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/Kubernetes%E5%A4%87%E4%BB%BD%E8%BF%98%E5%8E%9F%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> Kubernetes 六款备份还原工具 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/k8s%E6%8F%92%E4%BB%B6%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E4%B9%8Bkrew/ class=md-nav__link> <span class=md-ellipsis> k8s 插件管理工具之krew </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/%E6%9E%B6%E6%9E%84%E5%9B%BE%E7%A5%9E%E5%99%A8DaC%E4%B9%8BDiagram/ class=md-nav__link> <span class=md-ellipsis> 架构图神器DaC之Diagram </span> </a> </li> <li class=md-nav__item> <a href=../../operator/tools/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B9%8Bvelero%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> 云原生备份恢复之velero实战 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2 id=__nav_2_2_2_label tabindex=0> <span class=md-ellipsis> 部署 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> 部署 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../operator/deploy/Ceph%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85/ class=md-nav__link> <span class=md-ellipsis> Ceph机器安装部署 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/deploy/%E6%9C%80%E5%B0%8F%E5%8C%96K8s%E7%8E%AF%E5%A2%83%E4%B9%8Bminikube/ class=md-nav__link> <span class=md-ellipsis> 最小化K8s环境部署之Minikube </span> </a> </li> <li class=md-nav__item> <a href=../../operator/deploy/%E6%9C%80%E5%B0%8F%E5%8C%96K8s%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B9%8BK3s/ class=md-nav__link> <span class=md-ellipsis> 最小化K8s环境部署之K3s </span> </a> </li> <li class=md-nav__item> <a href=../../operator/deploy/%E6%9C%80%E5%B0%8F%E5%8C%96K8s%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B9%8BKind/ class=md-nav__link> <span class=md-ellipsis> 最小化K8s环境部署之Kind </span> </a> </li> <li class=md-nav__item> <a href=../../operator/deploy/%E6%9C%80%E5%B0%8F%E5%8C%96K8s%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B9%8BMicroK8s/ class=md-nav__link> <span class=md-ellipsis> 最小化K8s环境部署之MicroK8s </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3> <label class=md-nav__link for=__nav_2_2_3 id=__nav_2_2_3_label tabindex=0> <span class=md-ellipsis> servicemesh </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3> <span class="md-nav__icon md-icon"></span> servicemesh </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_3_1> <label class=md-nav__link for=__nav_2_2_3_1 id=__nav_2_2_3_1_label tabindex=0> <span class=md-ellipsis> istio </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_2_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_3_1> <span class="md-nav__icon md-icon"></span> istio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../servicemesh/istio/Envoy%E7%AC%94%E8%AE%B0/ class=md-nav__link> <span class=md-ellipsis> Envoy笔记 </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/服务网格进阶实战.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/详解.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E4%B9%8BXDS%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> Istio之XDS协议解析 </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E7%AC%94%E8%AE%B0%E4%B9%8BGateway/ class=md-nav__link> <span class=md-ellipsis> Istio笔记之Gateway </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E7%AC%94%E8%AE%B0%E4%B9%8Bpilot/ class=md-nav__link> <span class=md-ellipsis> Istio笔记之pilot </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E7%81%B0%E5%BA%A6%E5%8F%91%E5%B8%83/ class=md-nav__link> <span class=md-ellipsis> Istio灰度发布 </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio之流量管理.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E7%AE%80%E4%BB%8B%E5%8F%8A%E6%9E%B6%E6%9E%84/ class=md-nav__link> <span class=md-ellipsis> Istio简介及架构 </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%E7%AC%94%E8%AE%B0%28%E4%B8%80%29/ class=md-nav__link> <span class=md-ellipsis> Istio微服务治理笔记(一) </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/Istio%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%9C%8D%E5%8A%A1%E7%BD%91%E7%BB%9C/ class=md-nav__link> <span class=md-ellipsis> Istio基础之服务网络 </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/微服务金丝雀发布.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../../servicemesh/istio/istio%E7%AC%94%E8%AE%B0/ class=md-nav__link> <span class=md-ellipsis> istio笔记 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_4> <label class=md-nav__link for=__nav_2_2_4 id=__nav_2_2_4_label tabindex=0> <span class=md-ellipsis> 排错 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_4> <span class="md-nav__icon md-icon"></span> 排错 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../operator/other/k8s%20%E9%9B%86%E7%BE%A4etcd%E6%8E%92%E9%94%99/ class=md-nav__link> <span class=md-ellipsis> k8s 集群etcd排错 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/other/CronHPA/ class=md-nav__link> <span class=md-ellipsis> CronHPA初探 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/other/%E8%AE%B0%E4%B8%80%E6%AC%A1K8smaster%20%E8%8A%82%E7%82%B9%E4%B8%80%E6%AC%A1%E6%8E%92%E9%94%99%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> 记一次K8smaster 节点一次排错实战 </span> </a> </li> <li class=md-nav__item> <a href=../../operator/other/%E8%AE%B0%E4%B8%80%E6%AC%A1%E7%BA%BF%E4%B8%8Ak8s%E8%8A%82%E7%82%B9%E7%BB%B4%E6%8A%A4/ class=md-nav__link> <span class=md-ellipsis> 记一次线上k8s节点维护 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2_5> <label class=md-nav__link for=__nav_2_2_5 id=__nav_2_2_5_label tabindex=0> <span class=md-ellipsis> 容器 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2_5> <span class="md-nav__icon md-icon"></span> 容器 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/Dockerfile%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> Dockerfile 最佳实践 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/Docker%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> Docker底层原理 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/podman%E8%AF%A6%E8%A7%A3/ class=md-nav__link> <span class=md-ellipsis> Podman详解 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/%E5%88%A9%E7%94%A8katacoda%20%E5%AE%9E%E7%8E%B0%E6%8B%89%E5%8F%96%E5%9B%BD%E5%A4%96%E9%95%9C%E5%83%8F/ class=md-nav__link> <span class=md-ellipsis> 利用katacoda实现拉取国外镜像 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/%E9%95%9C%E5%83%8F%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/ class=md-nav__link> <span class=md-ellipsis> 镜像底层原理 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%B9%E5%99%A8/Harbor%E5%92%8Cregistry%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E9%83%A8%E7%BD%B2/ class=md-nav__link> <span class=md-ellipsis> Harbor/registry镜像仓库部署 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> 安全 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> 安全 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E4%B9%8BKube-bench/ class=md-nav__link> <span class=md-ellipsis> K8s 安全之Kube-bench </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubeeye%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> KubeEye源码分析 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E4%B9%8BKubeeye/ class=md-nav__link> <span class=md-ellipsis> Kubernetes安全之KubeEye </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E4%B9%8BNPD/ class=md-nav__link> <span class=md-ellipsis> Kubernetes安全之NPD </span> </a> </li> <li class=md-nav__item> <a href="../../安全/Kubernetes安全之Open/ Policy/ Agent.md" class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E4%B9%8Bopenebs/ class=md-nav__link> <span class=md-ellipsis> Kubernetes安全之openebs </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90/ class=md-nav__link> <span class=md-ellipsis> Kubernetes安全分析 </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/kubernetes%E5%AE%89%E5%85%A8%E4%B9%8BPolaris/ class=md-nav__link> <span class=md-ellipsis> kubernetes安全之Polaris </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/Kubernetes%E5%AE%89%E5%85%A8%E4%B9%8Bkubescape/ class=md-nav__link> <span class=md-ellipsis> Kubernetes安全扫描之kubescape </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/%E5%AE%B9%E5%99%A8%E9%95%9C%E5%83%8F%E5%AE%89%E5%85%A8%E4%B9%8BTrivy/ class=md-nav__link> <span class=md-ellipsis> 镜像安全扫描之Trivy </span> </a> </li> <li class=md-nav__item> <a href=../../%E5%AE%89%E5%85%A8/%E5%BC%80%E6%BA%90%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8%E5%B9%B3%E5%8F%B0%E4%B9%8BNeuVector/ class=md-nav__link> <span class=md-ellipsis> 开源容器安全平台之NeuVector </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4 checked> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> 其他 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=true> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../inside-kubernetes%20controller/ class=md-nav__link> <span class=md-ellipsis> Inside Kubernetes controller </span> </a> </li> <li class=md-nav__item> <a href=../Kubectl插件开发及开业分享.md class=md-nav__link> <span class=md-ellipsis> None </span> </a> </li> <li class=md-nav__item> <a href=../KubeEdge/ class=md-nav__link> <span class=md-ellipsis> KubeEdge初探 </span> </a> </li> <li class=md-nav__item> <a href=../Kubernetes%E5%BC%80%E5%8F%91%E6%8E%92%E9%94%99%E6%9D%82%E8%AE%B0/ class=md-nav__link> <span class=md-ellipsis> Kubernetes开发排错杂记 </span> </a> </li> <li class=md-nav__item> <a href=../Kubernetes%E7%94%9F%E6%88%90kubeconfig/ class=md-nav__link> <span class=md-ellipsis> Kubernetes生成kubeconfig </span> </a> </li> <li class=md-nav__item> <a href=../%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%8E%9F%E7%94%9FCCE%E5%AE%9E%E6%88%98/ class=md-nav__link> <span class=md-ellipsis> 华为云原生CCE实战 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 微服务API网关-Kong </span> </a> </li> <li class=md-nav__item> <a href=../%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E4%B8%AD10%E7%A7%8D%E5%B8%B8%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 微服务架构中10种常用设计模式 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> devops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> devops </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> GitLab CI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> GitLab CI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/01%E6%95%8F%E6%8D%B7%E6%97%A0%E6%95%8C%E4%B9%8B%E5%AE%9E%E6%88%98Gitlab%20CI/ class=md-nav__link> <span class=md-ellipsis> 1.敏捷无敌之Gitlab CI </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/02%E6%95%8F%E6%8D%B7%E6%97%A0%E6%95%8C%E4%B9%8BGitlab%20CI%E6%9E%B6%E6%9E%84%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3/ class=md-nav__link> <span class=md-ellipsis> 2.敏捷无敌之Gitlab CI架构流程详解 </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/03%E5%AE%9E%E6%88%98Gitlab%20CI%20%2B%20Supervisor%20%E5%8F%91%E5%B8%83Python%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> 3.实战Gitlab CI + Supervisor 发布Python项目 </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/04%E5%AE%9E%E6%88%98%E5%89%8D%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE%E5%8F%8A%E6%B7%B7%E5%90%88%E7%8E%AF%E5%A2%83Gitlab%20CI/ class=md-nav__link> <span class=md-ellipsis> 4.实战前后端项目及混合环境Gitlab CI </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/05%E5%AE%9E%E6%88%98Gitlab%20CI%20%2B%20Kubernetes%20%E4%BB%A3%E7%A0%81%E5%8F%91%E5%B8%83/ class=md-nav__link> <span class=md-ellipsis> 5.实战Kubernetes Gitlab CI </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/Gitlab%20CI%E4%B9%8B%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%92%8C%E4%BB%A3%E7%A0%81%E6%89%AB%E6%8F%8F/ class=md-nav__link> <span class=md-ellipsis> Gitlab CI之单元测试和代码扫描 </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/Gitlab%20CI/Gitlab%20CI%E8%BF%9B%E9%98%B6%E4%B9%8B%E5%85%B1%E4%BA%ABCI%E5%BA%93/ class=md-nav__link> <span class=md-ellipsis> Gitlab CI进阶之共享CI库 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> IaC </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> IaC </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../devops/IaC/Terraform/IaC%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%E4%B9%8BTerrascan/ class=md-nav__link> <span class=md-ellipsis> IaC扫描工具之Terrascan </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/IaC/Terraform/IaC%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E4%B9%8BTerratest/ class=md-nav__link> <span class=md-ellipsis> IaC测试工具之Terratest </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/IaC/Terraform/terraform-book/ class=md-nav__link> <span class=md-ellipsis> Terraform book </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/IaC/Terraform/Terraform%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%87%BD%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> Terraform 相关概念及函数 </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/IaC/Terraform/terraform%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> Terraform 最佳实践 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> 其他 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../devops/other/Argo%20CD/ class=md-nav__link> <span class=md-ellipsis> Argo CD </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/other/IaC%E4%B9%8BTerraform%20%E4%B8%8EPulumi%E4%BD%BF%E7%94%A8%E5%AF%B9%E6%AF%94/ class=md-nav__link> <span class=md-ellipsis> IaC之Terraform 与Pulumi使用对比 </span> </a> </li> <li class=md-nav__item> <a href=../../../devops/other/Packer/ class=md-nav__link> <span class=md-ellipsis> 镜像定义工具Packer实战 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> 开发技术 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 开发技术 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class=md-ellipsis> 设计模式 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> 设计模式 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1_1> <label class=md-nav__link for=__nav_4_1_1 id=__nav_4_1_1_label tabindex=0> <span class=md-ellipsis> 创建型 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1_1> <span class="md-nav__icon md-icon"></span> 创建型 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/01-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 1.简单工厂模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/02-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 2.工厂方法模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/03-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 3.抽象工厂模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/04-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 4.建造者(生成器)模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/05-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 5.单例模式 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1_2> <label class=md-nav__link for=__nav_4_1_2 id=__nav_4_1_2_label tabindex=0> <span class=md-ellipsis> 结构型 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1_2> <span class="md-nav__icon md-icon"></span> 结构型 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B/01-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 1.装饰器模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B/02-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 2.代理模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B/03-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 3.桥接模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B/04-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 4.适配器模式 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1_3> <label class=md-nav__link for=__nav_4_1_3 id=__nav_4_1_3_label tabindex=0> <span class=md-ellipsis> 行为型 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1_3> <span class="md-nav__icon md-icon"></span> 行为型 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B/01-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 1.策略模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B/02-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 2.观察者模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B/03-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E7%89%88%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 2.模版模式 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B/04-golang%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 4.职责链模式 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Golang </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_1> <label class=md-nav__link for=__nav_4_2_1 id=__nav_4_2_1_label tabindex=0> <span class=md-ellipsis> Gin </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_1> <span class="md-nav__icon md-icon"></span> Gin </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/Golang/gin/gin%20%E6%A1%86%E6%9E%B6%E5%AE%9E%E7%8E%B0%E7%83%AD%E5%8A%A0%E8%BD%BD/ class=md-nav__link> <span class=md-ellipsis> Gin框架热加载 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/Golang/gin/gin-swagger/ class=md-nav__link> <span class=md-ellipsis> Gin + Swagger快速生成API文档 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/Golang/gin/gin-validator%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/ class=md-nav__link> <span class=md-ellipsis> gin-validator参数校验 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/Golang/gin/gin%E6%A1%86%E6%9E%B6%E4%BC%98%E9%9B%85%E5%85%B3%E6%9C%BA%E9%87%8D%E5%90%AF/ class=md-nav__link> <span class=md-ellipsis> Gin框架优雅关机和重启 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_2> <label class=md-nav__link for=__nav_4_2_2 id=__nav_4_2_2_label tabindex=0> <span class=md-ellipsis> 开发规范 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_2> <span class="md-nav__icon md-icon"></span> 开发规范 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%80%A7%E8%83%BD01/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之性能01 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E8%A7%84%E8%8C%8301/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之规范01 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E8%A7%84%E8%8C%8302/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之规范02 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E8%A7%84%E8%8C%8303/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之规范03 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E8%A7%84%E8%8C%8304/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之规范04 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%9901/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之指导原则01 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%BC%8F01/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之编程模式01 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%9902/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之指导原则02 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%9903/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之指导原则03 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%9904/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之指导原则04 </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/%E8%A7%84%E8%8C%83/uber-go%20%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/Golang%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83%E4%B9%8B%E6%8C%87%E5%AF%BC%E5%8E%9F%E5%88%9905/ class=md-nav__link> <span class=md-ellipsis> Golang编码规范之指导原则05 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2_3> <label class=md-nav__link for=__nav_4_2_3 id=__nav_4_2_3_label tabindex=0> <span class=md-ellipsis> 其他 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2_3> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../develop/Golang/golang%20%E5%88%86%E5%B8%83%E5%BC%8F%E9%93%BE%E8%B7%AF%E6%9C%80%E7%BB%88%E4%B9%8Bjaeger/ class=md-nav__link> <span class=md-ellipsis> Golang 分布式链路追踪之jaeger </span> </a> </li> <li class=md-nav__item> <a href=../../../develop/Golang/golang%20%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/ class=md-nav__link> <span class=md-ellipsis> Go 内存对齐 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> 系统相关 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> 系统相关 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/system/Linux%20grub%3Agrub2%E8%AF%A6%E8%A7%A3/ class=md-nav__link> <span class=md-ellipsis> Linux grub/grub2详解 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/system/Linux%20%E5%86%85%E6%A0%B8%E5%BC%95%E5%AF%BC%E8%AF%A6%E8%A7%A3/ class=md-nav__link> <span class=md-ellipsis> Linux 内核引导详解 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/system/Linux%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ class=md-nav__link> <span class=md-ellipsis> Linux 系统安全加固最佳实践 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/system/virtio%E8%AF%A6%E8%A7%A3/ class=md-nav__link> <span class=md-ellipsis> Virtio 详解 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Shell </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/shell/Shell%E7%AE%80%E4%BB%8B/ class=md-nav__link> <span class=md-ellipsis> Shell 教程概述 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/1.%E7%AC%AC%E4%B8%80%E4%B8%AAshell%E7%A8%8B%E5%BA%8F/ class=md-nav__link> <span class=md-ellipsis> 1.第一个 Shell 程序 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/2.Shell%E5%8F%98%E9%87%8F/ class=md-nav__link> <span class=md-ellipsis> 2.Shell 变量 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/3.Shell%E5%8F%82%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 3.Shell 参数 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/4.Shell%E6%95%B0%E7%BB%84/ class=md-nav__link> <span class=md-ellipsis> 4.Shell数组 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/5.Shell%E8%BF%90%E7%AE%97%E7%AC%A6/ class=md-nav__link> <span class=md-ellipsis> 5.Shell 运算符 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/6.Shell%20echo%3Aprintf%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 6.Shell echo/printf 命令 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/7.Shell%20test%E5%91%BD%E4%BB%A4/ class=md-nav__link> <span class=md-ellipsis> 7.Shell test 命令 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/8.Shell%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/ class=md-nav__link> <span class=md-ellipsis> 8.Shell 流程控制 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/9.Shell%E5%87%BD%E6%95%B0/ class=md-nav__link> <span class=md-ellipsis> 8.Shell 函数 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/10.Shell%E8%BE%93%E5%85%A5%3A%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91/ class=md-nav__link> <span class=md-ellipsis> 10.Shell输入/输出重定向 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/11.Shell%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/ class=md-nav__link> <span class=md-ellipsis> 11.Shell 正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/12.Shell%20%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bgrep/ class=md-nav__link> <span class=md-ellipsis> 12.Shell 三剑客之grep </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/13.Shell%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bsed/ class=md-nav__link> <span class=md-ellipsis> 13.Shell三剑客之sed </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/14.Shell%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bawk/ class=md-nav__link> <span class=md-ellipsis> 14.Shell三剑客之awk </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/15.Shell%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/ class=md-nav__link> <span class=md-ellipsis> 15.Shell常用工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../linux/shell/16.Shell%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/ class=md-nav__link> <span class=md-ellipsis> 16.Shell实战项目 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> 其他 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> 其他 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../other/ class=md-nav__link> <span class=md-ellipsis> 工具 </span> </a> </li> <li class=md-nav__item> <a href=../../../other/ class=md-nav__link> <span class=md-ellipsis> 杂记 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=api-kong>微服务API网关-Kong<a class=headerlink href=#api-kong title="Permanent link">&para;</a></h1> <h1 id=_1>一 概述<a class=headerlink href=#_1 title="Permanent link">&para;</a></h1> <p>Kong是一个clould-native、快速的、可扩展的、分布式的微服务抽象层（也称为API网关、API中间件或在某些情况下称为服务网格）框架。更确切地说，Kong是一个在Nginx中运行的Lua应用程序，并且可以通过<a href=https://github.com/openresty/lua-nginx-module>lua-nginx模块实现</a>。Kong不是用这个模块编译Nginx，而是与<a href=https://openresty.org/ >OpenResty</a>一起发布，<a href=https://openresty.org/ >OpenResty</a>已经包含了lua-nginx-module。OpenResty <em>不是</em> Nginx的分支，而是一组扩展其功能的模块。</p> <p>这为可插拔架构奠定了基础，可以在运行时启用和执行Lua脚本（称为*“插件”<em>）。因此，我们认为Kong是**微服务架构的典范*</em>：它的核心是实现数据库抽象，路由和插件管理。插件可以存在于单独的代码库中，并且可以在几行代码中注入到请求生命周期的任何位置。Kong作为开源项目在2015年推出，它的核心价值是高性能和可扩展性。</p> <p>Kong被广泛用于从初创企业到全球5000家公司以及政府组织的生产环境中。</p> <p>如果构建Web、移动或IoT（物联网）应用，可能最终需要使用通用的功能来实现这些应用。Kong充当微服务请求的网关（或侧车），通过插件能够提供**负载平衡**、**日志记录、身份验证、速率限制、转换**等能力。</p> <p>一个service可以创建多个routes，routes就相当于前端配置，可以隐藏业务真正的接口地址，service指定后端真实的转发接口地址，在kong上进行认证/鉴权/日志/分析/监控等控制。</p> <h1 id=_2>二 特性<a class=headerlink href=#_2 title="Permanent link">&para;</a></h1> <ul> <li>云原生(<strong>Cloud-Native</strong>)：Kong可以在Kubernetes或物理环境上运行；</li> <li>动态**负载平衡**(<strong>Dynamic Load Balancing</strong>)：跨多个上游服务的负载平衡业务。</li> <li>基于哈希的负载平衡(<strong>Hash-based Load Balancing</strong>)：一致的散列/粘性会话的负载平衡。</li> <li>断路器(<strong>Circuit-Breaker</strong>)：智能跟踪不健康的上游服务。</li> <li>健康检查(<strong>Health Checks</strong>)：主动和被动监控您的上游服务。</li> <li><strong>服务发现</strong>(<strong>Service Discovery</strong>)：解决如Consul等第三方DNS解析器的SRV记录。</li> <li>无服务器(<strong>Serverless</strong>)：从Kong中直接调用和保证AWS或OpenWhisk函数安全。</li> <li><strong>WebSockets</strong>：通过**WebSockets**与上游服务进行通信。</li> <li>OAuth2.0：轻松的向API中添加OAuth2.0认证。</li> <li><strong>日志记录</strong>(<strong>Logging</strong>)：通过HTTP、TCP、UDP记录请求或者相应的日志，存储在磁盘中。</li> <li><strong>安全</strong>(<strong>Security</strong>)：ACL，Bot检测，IPs白名单/黑名单等。</li> <li>系统日志(<strong>Syslog</strong>)：记录信息到系统日志。</li> <li>SSL：为基础服务或API设置特定的SSL证书。</li> <li><strong>监视</strong>(<strong>Monitoring)</strong>：能够实时对关键负载和性能指标进行监控。</li> <li>转发代理(<strong>Forward Proxy</strong>)：使端口连接到中间透明的HTTP代理。</li> <li><strong>认证</strong>(<strong>Authentications</strong>)：支持HMAC，JWT和BASIC方式进行认证等等。</li> <li><strong>速率限制</strong>(<strong>Rate-limiting</strong>)：基于多个变量的阻塞和节流请求。</li> <li>转换(<strong>Transformations</strong>)：添加、删除或操作HTTP请求和响应。</li> <li><strong>缓存</strong>(<strong>Caching</strong>)：在代理层进行缓存和服务响应。</li> <li>命令行工具(CLI)：能够通过命令行控制Kong的集群。</li> <li>REST API：可以通过REST API灵活的操作Kong。</li> <li>GEO复制：在不同的区域，配置总是最新的。</li> <li><strong>故障检测与恢**复(**Failure Detection &amp; Recovery</strong>)：如果Cassandra节点失效，Kong并不会受影响。</li> <li>群集(<strong>Clustering</strong>)：所有的Kong节点会自动加入群集，并更新各个节点上的配置。</li> <li>可扩展性(<strong>Scalability</strong>)：通过添加节点，实现水平缩放。</li> <li>性能(<strong>Performance</strong>)：通过缩放和使用Nigix，Kong能够轻松处理负载。</li> <li>插件(<strong>Plugins</strong>)：基于插件的可扩展体系结构，能够方便的向Kong和API添加功能。</li> </ul> <h1 id=_3>三 依赖组件<a class=headerlink href=#_3 title="Permanent link">&para;</a></h1> <p>Kong部署在Nginx和Apache Cassandra或PostgreSQL等可靠技术之上，并提供了易于使用的RESTful API来操作和配置系统。下面是Kong的技术逻辑图。基于这些技术，Kong提供相关的特性支持：</p> <h2 id=31-nginx>3.1 Nginx<a class=headerlink href=#31-nginx title="Permanent link">&para;</a></h2> <ul> <li>经过验证的高性能基础；</li> <li>HTTP和反向代理服务器；</li> <li>处理低层级的操作。</li> </ul> <h2 id=32-openrestry>3.2 OpenRestry<a class=headerlink href=#32-openrestry title="Permanent link">&para;</a></h2> <ul> <li>支持Lua脚本；</li> <li>拦截请求/响应生命周期；</li> <li>基于Nginx进行扩展。</li> </ul> <h2 id=33-clusteringdatastore>3.3 Clustering&amp;Datastore<a class=headerlink href=#33-clusteringdatastore title="Permanent link">&para;</a></h2> <ul> <li>支持Cassandra或PostgreSQL数据库；</li> <li>内存级的缓存；</li> <li>支持水平扩展。</li> </ul> <h2 id=34-plugins>3.4 Plugins<a class=headerlink href=#34-plugins title="Permanent link">&para;</a></h2> <ul> <li>使用Lua创建插件；</li> <li>功能强大的定制能力；</li> <li>与第三方服务实现集成。</li> </ul> <h2 id=35-restful-administration-api>3.5 Restful Administration API<a class=headerlink href=#35-restful-administration-api title="Permanent link">&para;</a></h2> <ul> <li>通过Restful API管理Kong；</li> <li>支持CI/CD&amp;DevOps；</li> <li>基于插件的可扩展。</li> </ul> <h1 id=_4>四 架构图<a class=headerlink href=#_4 title="Permanent link">&para;</a></h1> <p><img alt=img src=https://www.kubernetes.org.cn/img/2018/12/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20181213063707.png></p> <h1 id=_5>五 部署<a class=headerlink href=#_5 title="Permanent link">&para;</a></h1> <h2 id=51>5.1 物理服务器部署<a class=headerlink href=#51 title="Permanent link">&para;</a></h2> <h3 id=511-yum>5.1.1 配置yum源<a class=headerlink href=#511-yum title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>sudo<span class=w> </span>yum<span class=w> </span>update<span class=w> </span>-y
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>sudo<span class=w> </span>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>wget
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>wget<span class=w> </span>https://bintray.com/kong/kong-rpm/rpm<span class=w> </span>-O<span class=w> </span>bintray-kong-kong-rpm.repo
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=nb>export</span><span class=w> </span><span class=nv>major_version</span><span class=o>=</span><span class=sb>`</span>grep<span class=w> </span>-oE<span class=w> </span><span class=s1>&#39;[0-9]+\.[0-9]+&#39;</span><span class=w> </span>/etc/redhat-release<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=w> </span><span class=s2>&quot;.&quot;</span><span class=w> </span>-f1<span class=sb>`</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>sed<span class=w> </span>-i<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;s/baseurl.*/&amp;\/centos\/&#39;</span><span class=nv>$major_version</span><span class=s1>&#39;&#39;</span>/<span class=w> </span>bintray-kong-kong-rpm.repo
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>sudo<span class=w> </span>mv<span class=w> </span>bintray-kong-kong-rpm.repo<span class=w> </span>/etc/yum.repos.d/
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>sudo<span class=w> </span>yum<span class=w> </span>update<span class=w> </span>-y
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>sudo<span class=w> </span>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>kong
</code></pre></div> <h3 id=512>5.1.2 数据库安装<a class=headerlink href=#512 title="Permanent link">&para;</a></h3> <p>Kong支持PostgreSQL v9.5+和Cassandra 3.x.x作为数据存储。</p> <p>此处我按照文档安装PostgreSQL v11: <a href=https://www.postgresql.org/download/linux/redhat/ >https://www.postgresql.org/download/linux/redhat/</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># 安装PostgreSQL v11</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>https://download.postgresql.org/pub/repos/yum/11/redhat/rhel-7-x86_64/pgdg-centos11-11-2.noarch.rpm
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>yum<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>postgresql11<span class=w> </span>postgresql11-server
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=c1># 自启</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>/usr/pgsql-11/bin/postgresql-11-setup<span class=w> </span>initdb
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>systemctl<span class=w> </span><span class=nb>enable</span><span class=w> </span>postgresql-11
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>systemctl<span class=w> </span>start<span class=w> </span>postgresql-11
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># 登录psql</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>sudo<span class=w> </span>su<span class=w> </span>postgres
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>psql
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># 创建数据库，官方默认无密码，此处我使用密码</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1># CREATE USER kong; CREATE DATABASE kong OWNER kong;</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>CREATE<span class=w> </span>USER<span class=w> </span>kong<span class=w> </span>with<span class=w> </span>password<span class=w> </span><span class=s1>&#39;kong&#39;</span><span class=p>;</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>CREATE<span class=w> </span>DATABASE<span class=w> </span>kong<span class=w> </span>OWNER<span class=w> </span>kong<span class=p>;</span><span class=w> </span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>grant<span class=w> </span>all<span class=w> </span>privileges<span class=w> </span>on<span class=w> </span>database<span class=w> </span>kong<span class=w> </span>to<span class=w> </span>kong<span class=p>;</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=c1># 这里可能会报连接错误</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=c1># psql: 致命错误:  对用户&quot;kong&quot;的对等认证失败</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>sudo<span class=w> </span>find<span class=w> </span>/<span class=w> </span>-name<span class=w> </span>pg_hba.conf
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>/var/lib/pgsql/11/data/pg_hba.conf
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=c1># 修改安全配置</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>vim<span class=w> </span>/var/lib/pgsql/11/data/pg_hba.conf
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=c1># METHOD指定如何处理客户端的认证。常用的有ident，md5，password，trust，reject</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=c1># ident是Linux下PostgreSQL默认的local认证方式，凡是能正确登录服务器的操作系统用户（注：不是数据库用户）就能使用本用户映射的数据库用户不需密码登录数据库。</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=c1># md5是常用的密码认证方式，如果你不使用ident，最好使用md5。密码是以md5形式传送给数据库，较安全，且不需建立同名的操作系统用户。</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># password是以明文密码传送给数据库，建议不要在生产环境中使用。</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=c1># trust是只要知道数据库用户名就不需要密码或ident就能登录，建议不要在生产环境中使用。</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=c1># reject是拒绝认证。</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=c1># &quot;local&quot; is for Unix domain socket connections only</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=nb>local</span><span class=w>   </span>all<span class=w>             </span>all<span class=w>                                     </span>md5
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=c1># IPv4 local connections:</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a>host<span class=w>    </span>all<span class=w>             </span>all<span class=w>             </span><span class=m>127</span>.0.0.1/32<span class=w>            </span>md5
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=c1># IPv6 local connections:</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>host<span class=w>    </span>all<span class=w>             </span>all<span class=w>             </span>::1/128<span class=w>                 </span>md5
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=c1># 将peer改为md5（）</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=c1># &quot;local&quot; is for Unix domain socket connections only</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=nb>local</span><span class=w>   </span>all<span class=w>             </span>all<span class=w>                                     </span>md5
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=c1># IPv4 local connections:</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a>host<span class=w>    </span>all<span class=w>             </span>all<span class=w>             </span><span class=m>127</span>.0.0.1/32<span class=w>            </span>ident
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=c1># IPv6 local connections:</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a>host<span class=w>    </span>all<span class=w>             </span>all<span class=w>             </span>::1/128<span class=w>                 </span>ident
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=c1># 重启psql</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a>systemctl<span class=w> </span>restart<span class=w> </span>postgresql-11
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=c1># 登录postgre</span>
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a>psql<span class=w> </span>-U<span class=w> </span>kong
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=c1># 输入密码</span>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a>
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=c1># 查看帮助</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a><span class=se>\h</span>
<a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a>
<a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=c1># 退出</span>
<a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a><span class=se>\q</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># 这里需要提前配置kong配置文件，默认/etc/kong/kong.conf.default</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>cp<span class=w> </span>/etc/kong/kong.conf.default<span class=w> </span>/etc/kong/kong.conf
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># 修改里面的数据库配置，写入用户、密码、数据库、端口等信息</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>vim<span class=w> </span>/etc/kong/kong.conf
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># egrep -v &quot;^#|^$|^[[:space:]]+#&quot; /etc/kong/kong.conf</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=nv>database</span><span class=w> </span><span class=o>=</span><span class=w> </span>postgres<span class=w>             </span><span class=c1># Determines which of PostgreSQL or Cassandra</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=nv>pg_host</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>127</span>.0.0.1<span class=w>             </span><span class=c1># Host of the Postgres server.</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=nv>pg_port</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>5432</span><span class=w>                  </span><span class=c1># Port of the Postgres server.</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=nv>pg_timeout</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>5000</span><span class=w>               </span><span class=c1># Defines the timeout (in ms), for connecting,</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=nv>pg_user</span><span class=w> </span><span class=o>=</span><span class=w> </span>kong<span class=w>                  </span><span class=c1># Postgres user.</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=nv>pg_password</span><span class=w> </span><span class=o>=</span><span class=w> </span>kong<span class=w>                </span><span class=c1># Postgres user&#39;s password.</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=nv>pg_database</span><span class=w> </span><span class=o>=</span><span class=w> </span>kong<span class=w>              </span><span class=c1># The database name to connect to.  </span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=c1># Kong migrations</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>kong<span class=w> </span>migrations<span class=w> </span>bootstrap<span class=w> </span><span class=o>[</span>-c<span class=w> </span>/path/to/kong.conf<span class=o>]</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># kong migrations bootstrap -c /etc/kong/kong.conf</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>Bootstrapping<span class=w> </span>database...
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>migrating<span class=w> </span>core<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>002_15_to_1<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>003_100_to_110<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>004_110_to_120<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>core<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>005_120_to_130<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>migrating<span class=w> </span>hmac-auth<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>hmac-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_hmac_auth<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>hmac-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>migrating<span class=w> </span>oauth2<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>oauth2<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_oauth2<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>oauth2<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a>oauth2<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>002_15_to_10<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>migrating<span class=w> </span>jwt<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>jwt<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_jwt<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>jwt<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>migrating<span class=w> </span>basic-auth<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>basic-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_basic_auth<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>basic-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a>migrating<span class=w> </span>key-auth<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a>key-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_key_auth<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a>key-auth<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a>migrating<span class=w> </span>rate-limiting<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a>rate-limiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_rate_limiting<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a>rate-limiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>rate-limiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>002_15_to_10<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a>rate-limiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>003_10_to_112<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a>migrating<span class=w> </span>acl<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a>acl<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_acl<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a>acl<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a>migrating<span class=w> </span>response-ratelimiting<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a>response-ratelimiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_response_rate_limiting<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a>response-ratelimiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>001_14_to_15<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a>response-ratelimiting<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>002_15_to_10<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a>migrating<span class=w> </span>session<span class=w> </span>on<span class=w> </span>database<span class=w> </span><span class=s1>&#39;kong&#39;</span>...
<a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a>session<span class=w> </span>migrated<span class=w> </span>up<span class=w> </span>to:<span class=w> </span>000_base_session<span class=w> </span><span class=o>(</span>executed<span class=o>)</span>
<a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=m>27</span><span class=w> </span>migrations<span class=w> </span>processed
<a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a><span class=m>27</span><span class=w> </span>executed
<a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a>Database<span class=w> </span>is<span class=w> </span>up-to-date
</code></pre></div> <h3 id=512-kong>5.1.2 启动kong<a class=headerlink href=#512-kong title="Permanent link">&para;</a></h3> <p>在无数据库模式配置Kong,一旦Kong启动，访问Admin API的<code>/</code>根端点已验证它是否在没有数据库的情况下运行。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a># Setting Up Kong in DB-less mode
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>要在无数据库模式下使用Kong，有两种方式：
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>修改配置文件kong.conf
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>vim /etc/kong/kong.conf
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a># database = postgres
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>database=off
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a># 或
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>export KONG_DATABASE=off
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a># 检查配置，此命令将考虑您当前设置的环境变量，并在设置无效时报错。此外，您还可以在调试模式下使用CLI，以便更深入地了解Kong的启动属性
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>kong start -c &lt;kong.conf&gt; --vv
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a># 启动kong
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>kong start -c /etc/kong/kong.conf
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>kong<span class=w> </span>start<span class=w> </span><span class=o>[</span>-c<span class=w> </span>/path/to/kong.conf<span class=o>]</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># kong start -c /etc/kong/kong.conf</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>Kong<span class=w> </span>started
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># kong  health</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>nginx.......running
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>Kong<span class=w> </span>is<span class=w> </span>healthy<span class=w> </span>at<span class=w> </span>/usr/local/kong
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># netstat -lntup</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>Active<span class=w> </span>Internet<span class=w> </span>connections<span class=w> </span><span class=o>(</span>only<span class=w> </span>servers<span class=o>)</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>Proto<span class=w> </span>Recv-Q<span class=w> </span>Send-Q<span class=w> </span>Local<span class=w> </span>Address<span class=w>           </span>Foreign<span class=w> </span>Address<span class=w>         </span>State<span class=w>       </span>PID/Program<span class=w> </span>name
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>127</span>.0.0.1:8444<span class=w>          </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>31050</span>/nginx:<span class=w> </span>master
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>0</span>.0.0.0:8000<span class=w>            </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>31050</span>/nginx:<span class=w> </span>master
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>127</span>.0.0.1:8001<span class=w>          </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>31050</span>/nginx:<span class=w> </span>master
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>0</span>.0.0.0:22<span class=w>              </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>1453</span>/sshd
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>127</span>.0.0.1:5432<span class=w>          </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>30638</span>/postmaster
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>tcp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>0</span>.0.0.0:8443<span class=w>            </span><span class=m>0</span>.0.0.0:*<span class=w>               </span>LISTEN<span class=w>      </span><span class=m>31050</span>/nginx:<span class=w> </span>master
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>tcp6<span class=w>       </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span>::1:5432<span class=w>                </span>:::*<span class=w>                    </span>LISTEN<span class=w>      </span><span class=m>30638</span>/postmaster
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>udp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>0</span>.0.0.0:68<span class=w>              </span><span class=m>0</span>.0.0.0:*<span class=w>                           </span><span class=m>780</span>/dhclient
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>udp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>172</span>.16.16.16:123<span class=w>        </span><span class=m>0</span>.0.0.0:*<span class=w>                           </span><span class=m>3006</span>/ntpd
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>udp<span class=w>        </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span><span class=m>127</span>.0.0.1:123<span class=w>           </span><span class=m>0</span>.0.0.0:*<span class=w>                           </span><span class=m>3006</span>/ntpd
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>udp6<span class=w>       </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span>fe80::5054:ff:fe94::123<span class=w> </span>:::*<span class=w>                                </span><span class=m>3006</span>/ntpd
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>udp6<span class=w>       </span><span class=m>0</span><span class=w>      </span><span class=m>0</span><span class=w> </span>::1:123<span class=w>                 </span>:::*<span class=w>                                </span><span class=m>3006</span>/ntpd
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=o>[</span>root@kong-server<span class=w> </span>software<span class=o>]</span><span class=c1># curl http://localhost:8001</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>停止:
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>kong<span class=w> </span>stop
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>重新加载：
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>kong<span class=w> </span>reload
</code></pre></div> <h3 id=513-konga>5.1.3 安装konga<a class=headerlink href=#513-konga title="Permanent link">&para;</a></h3> <p>konga为目前最先版本的kong的dashboard，由于kong-dashboard目前为更新适应新版本的kong，推荐使用konga</p> <p>konga带来的一个最大的便利就是可以很好地通过UI观察到现在kong的所有的配置，并且可以对于管理kong节点情况进行查看、监控和预警，konga主要特性如下：</p> <ul> <li>多用户管理</li> <li>管理多个Kong节点</li> <li>电子邮件异常信息通知</li> <li>管理所有Kong Admin API</li> <li>使用快照备份，还原和迁移Kong节点</li> <li>使用运行状况检查监控节点和API状态</li> <li> <p>轻松的数据库集成（MySQL，postgresSQL，MongoDB）</p> </li> <li> <p>node安装</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>yum<span class=w> </span>-y<span class=w> </span>install<span class=w> </span>git
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=nb>cd</span><span class=w> </span>/data/software<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span>wget<span class=w> </span>https://npm.taobao.org/mirrors/node/v10.16.2/node-v10.16.2-linux-x64.tar.xz
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>tar<span class=w> </span>-xf<span class=w> </span>node-v10.16.2-linux-x64.tar.xz<span class=w> </span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>mv<span class=w> </span>node-v10.16.2-linux-x64<span class=w> </span>node
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1># 修改为root的权限</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>chown<span class=w> </span>root.root<span class=w> </span>node<span class=w> </span>-R
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>cat<span class=w> </span>&gt;<span class=w> </span>/etc/profile.d/node.sh<span class=w> </span><span class=s>&lt;&lt; EOF</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=s>export PATH=\$PATH:/data/software/node/bin</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=s>EOF</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=nb>source</span><span class=w> </span>/etc/profile.d/node.sh
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>node<span class=w> </span>-v
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=c1># 安装插件</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>glup
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>bower
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>sails
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>node-gyp
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>grunt-sass
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>npm<span class=w> </span>install<span class=w> </span>-g<span class=w> </span>node-sass
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>npm<span class=w> </span>run<span class=w> </span>bower-deps
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>npm<span class=w> </span>install<span class=w> </span>sails-postgresql
</code></pre></div> <ul> <li>安装konga</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>git<span class=w> </span>clone<span class=w> </span>https://github.com/pantsel/konga.git
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=nb>cd</span><span class=w> </span>konga
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>npm<span class=w> </span>install<span class=w> </span>konga
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=c1>#使用postgresql</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>CREATE<span class=w> </span>USER<span class=w> </span>konga<span class=w> </span>with<span class=w> </span>password<span class=w> </span><span class=s1>&#39;konga&#39;</span><span class=p>;</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>CREATE<span class=w> </span>DATABASE<span class=w> </span>konga<span class=w> </span>OWNER<span class=w> </span>konga<span class=p>;</span><span class=w> </span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>grant<span class=w> </span>all<span class=w> </span>privileges<span class=w> </span>on<span class=w> </span>database<span class=w> </span>konga<span class=w> </span>to<span class=w> </span>konga<span class=p>;</span>
</code></pre></div> <ul> <li>配置</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>cp<span class=w> </span>config/local_example.js<span class=w> </span>config/local.js
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=c1># 配置默认数据库</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>vi<span class=w> </span>./local.js
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>models:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>    </span>connection:<span class=w> </span>process.env.DB_ADAPTER<span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;localDiskDb&#39;</span>,
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=o>}</span>,
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=c1># 改成</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>models:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>    </span>connection:<span class=w> </span>process.env.DB_ADAPTER<span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;postgres&#39;</span>,<span class=w> </span>//<span class=w> </span>这里可以用‘mysql’，‘mongo’，‘sqlserver’，‘postgres’
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=o>}</span>,
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=c1># 保存</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=c1># 修改数据库默认配置</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>vi<span class=w> </span>connections.js
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>  </span>postgres:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>    </span>adapter:<span class=w> </span><span class=s1>&#39;sails-postgresql&#39;</span>,
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=w>    </span>url:<span class=w> </span>process.env.DB_URI,
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=w>    </span>host:<span class=w> </span>process.env.DB_HOST<span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;localhost&#39;</span>,
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=w>    </span>user:<span class=w>  </span>process.env.DB_USER<span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;konga&#39;</span>,
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=w>    </span>password:<span class=w> </span>process.env.DB_PASSWORD<span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;konga&#39;</span>,
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=w>    </span>port:<span class=w> </span>process.env.DB_PORT<span class=w> </span><span class=o>||</span><span class=w> </span><span class=m>5432</span>,
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=w>    </span>database:<span class=w> </span>process.env.DB_DATABASE<span class=w> </span><span class=o>||</span><span class=s1>&#39;konga&#39;</span>,
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=w>    </span>//<span class=w> </span>schema:<span class=w> </span>process.env.DB_PG_SCHEMA<span class=w> </span><span class=o>||</span><span class=s1>&#39;public&#39;</span>,
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=w>    </span>poolSize:<span class=w> </span>process.env.DB_POOLSIZE<span class=w> </span><span class=o>||</span><span class=w> </span><span class=m>10</span>,
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=w>    </span>ssl:<span class=w> </span>process.env.DB_SSL<span class=w> </span>?<span class=w> </span><span class=nb>true</span><span class=w> </span>:<span class=w> </span><span class=nb>false</span><span class=w> </span>//<span class=w> </span>If<span class=w> </span>set,<span class=w> </span>assume<span class=w> </span>it<span class=s1>&#39;s true</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=s1>  },</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=s1># 保存</span>
<a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>
<a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=s1># 启动</span>
<a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=s1>cd ../</span>
<a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=s1>npm start</span>
<a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>
<a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>
<a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a><span class=s1># pm2 管理</span>
<a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=s1>npm install -g pm2 </span>
<a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=s1>cd konga</span>
<a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=s1>pm2 start app.js --name konga</span>
<a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>
<a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>
<a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=s1>pm2 logs</span>
<a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>
<a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=s1>0|konga    | info:    Sails              &lt;|    .-..-.</span>
<a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=s1>0|konga    | info:    v0.12.14            |\</span>
<a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=s1>0|konga    | info:                       /|.\</span>
<a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=s1>0|konga    | info:                      / || \</span>
<a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=s1>0|konga    | info:                    ,&#39;</span><span class=w>  </span><span class=p>|</span><span class=s1>&#39;  \</span>
<a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a><span class=s1>0|konga    | info:                 .-&#39;</span>.-<span class=o>==</span><span class=p>|</span>/_--<span class=s1>&#39;</span>
<a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a><span class=s1>0|konga    | info:                 `--&#39;</span>-------<span class=err>&#39;</span>
<a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:<span class=w>    </span>__---___--___---___--___---___--___
<a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:<span class=w>  </span>____---___--___---___--___---___--___-__
<a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:
<a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:<span class=w> </span>Server<span class=w> </span>lifted<span class=w> </span><span class=k>in</span><span class=w> </span><span class=sb>`</span>/data/software/konga<span class=sb>`</span>
<a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:<span class=w> </span>To<span class=w> </span>see<span class=w> </span>your<span class=w> </span>app,<span class=w> </span>visit<span class=w> </span>http://localhost:1338
<a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span><span class=w> </span>info:<span class=w> </span>To<span class=w> </span>shut<span class=w> </span>down<span class=w> </span>Sails,<span class=w> </span>press<span class=w> </span>&lt;CTRL&gt;<span class=w> </span>+<span class=w> </span>C<span class=w> </span>at<span class=w> </span>any<span class=w> </span>time.
<a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span>
<a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a><span class=m>0</span><span class=p>|</span>konga<span class=w>    </span><span class=p>|</span>
</code></pre></div> <ul> <li>访问</li> </ul> <p>IP:1338,默认用户：admin，密码：adminadminadmin</p> <p>配置链接kong, <a href=http://localhost:8001>http://localhost:8001</a></p> <p><img alt=image-20190817125412108 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817125412108.png"></p> <p><img alt=image-20190817125524680 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817125524680.png"></p> <h2 id=52-docker>5.2 docker中运行<a class=headerlink href=#52-docker title="Permanent link">&para;</a></h2> <h3 id=521-docker>5.2.1 Docker中部署<a class=headerlink href=#521-docker title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=m>1</span>.您需要创建一个自定义网络，以允许容器相互发现和通信。在此示例中kong-net是网络名称，您可以使用任何名称。
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>docker<span class=w> </span>network<span class=w> </span>create<span class=w> </span>kong-net
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=m>2</span>.启动数据库PostgreSQL
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>docker<span class=w> </span>run<span class=w> </span>-d<span class=w> </span>--name<span class=w> </span>kong-database<span class=w> </span>--network<span class=o>=</span>kong-net<span class=w> </span>-p<span class=w> </span><span class=m>5432</span>:5432<span class=w> </span>-e<span class=w> </span><span class=s2>&quot;POSTGRES_USER=kong&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;POSTGRES_DB=kong&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;POSTGRES_PASSWORD=kong&quot;</span><span class=w> </span>postgres
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=m>3</span>.准备数据库
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span>--network<span class=o>=</span>kong-net<span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_DATABASE=postgres&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PG_HOST=kong-database&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PG_PASSWORD=kong&quot;</span><span class=w> </span>kong<span class=w> </span>kong<span class=w> </span>migrations<span class=w> </span>bootstrap
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=m>4</span>.启动kong
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>docker<span class=w> </span>run<span class=w> </span>-d<span class=w> </span>--name<span class=w> </span>kong<span class=w> </span>--network<span class=o>=</span>kong-net<span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_DATABASE=postgres&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PG_HOST=kong-database&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PG_PASSWORD=kong&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot;</span><span class=w> </span>-p<span class=w> </span><span class=m>8000</span>:8000<span class=w> </span>-p<span class=w> </span><span class=m>8443</span>:8443<span class=w> </span>-p<span class=w> </span><span class=m>8001</span>:8001<span class=w> </span>-p<span class=w> </span><span class=m>8444</span>:8444<span class=w> </span>kong
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=m>5</span>.运行konga
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>注意DB_HOST为自己的ip地址
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>docker<span class=w> </span>run<span class=w> </span>-d<span class=w> </span>-p<span class=w> </span><span class=m>1337</span>:1337<span class=w> </span>--network<span class=w> </span>kong-net<span class=w> </span>-e<span class=w> </span><span class=s2>&quot;TOKEN_SECRET=mark666&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_ADAPTER=postgres&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_HOST=10.234.2.204&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_PORT=5432:5432&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_USER=kong&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_PASSWORD=kong&quot;</span><span class=w> </span>-e<span class=w> </span><span class=s2>&quot;DB_DATABASE=kong_database&quot;</span><span class=w> </span>--name<span class=w> </span>konga<span class=w> </span>pantsel/konga
</code></pre></div> <h3 id=522-docker-compose>5.2.2 docker-compose部署<a class=headerlink href=#522-docker-compose title="Permanent link">&para;</a></h3> <ul> <li>创建虚拟网络</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>docker<span class=w> </span>network<span class=w> </span>create<span class=w> </span>kong-net
</code></pre></div> <p>后续的应用及数据库都使用这个虚拟网络。</p> <ul> <li>编写docker-compose.yaml</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>version:<span class=w> </span><span class=s2>&quot;3.7&quot;</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>services:<span class=w> </span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>  </span>kong:
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span><span class=c1># 镜像版本，目前最新</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span>image:<span class=w> </span>kong:1.1.2
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span>environment:
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span><span class=c1># 数据持久化方式，使用postgres数据库</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_DATABASE=postgres&quot;</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>    </span><span class=c1># 数据库容器名称,Kong连接数据时使用些名称</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_PG_HOST=kong-database&quot;</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>    </span><span class=c1># 数据库名称</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>    </span><span class=c1># 日志记录目录</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot;</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot;</span>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot;</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot;</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=w>    </span><span class=c1># 暴露的端口</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot;</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>    </span>ports:
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>     </span>-<span class=w> </span><span class=m>8000</span>:8000
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w>     </span>-<span class=w> </span><span class=m>8443</span>:8443
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=w>     </span>-<span class=w> </span><span class=m>8001</span>:8001
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=w>     </span>-<span class=w> </span><span class=m>8444</span>:8444
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=w>    </span><span class=c1># 使用docker网络</span>
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=w>    </span>networks:
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=w>     </span>-<span class=w> </span>kong-net
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>    </span><span class=c1># 依赖数据库服务</span>
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>    </span>depends_on:
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>      </span>-<span class=w> </span>kong-database
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=c1># kong 管理界面</span>
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>  </span>konga:
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>    </span>image:<span class=w> </span>pantsel/konga
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>    </span>environment:
<a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;TOKEN_SECRET=51liveup.cn&quot;</span>
<a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>     </span>-<span class=w> </span><span class=s2>&quot;NODE_ENV=production&quot;</span>
<a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>    </span>ports:
<a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>     </span>-<span class=w> </span><span class=m>8080</span>:1337
<a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>    </span>networks:
<a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>     </span>-<span class=w> </span>kong-net
<a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a>
<a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=w>    </span>depends_on:
<a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a><span class=w>      </span>-<span class=w> </span>kong-database
<a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=w>      </span>-<span class=w> </span>
<a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=c1># 数据库服务</span>
<a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=w>  </span>kong-database:
<a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a><span class=w>    </span>image:<span class=w> </span>postgres:9.6
<a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=w>    </span>ports:
<a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=w>      </span>-<span class=w> </span><span class=s2>&quot;5432:5432&quot;</span>
<a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=w>    </span>environment:
<a id=__codelineno-11-52 name=__codelineno-11-52 href=#__codelineno-11-52></a><span class=w>    </span><span class=c1># 访问数据库的用户</span>
<a id=__codelineno-11-53 name=__codelineno-11-53 href=#__codelineno-11-53></a><span class=w>      </span>-<span class=w> </span><span class=nv>POSTGRES_USER</span><span class=o>=</span>kong
<a id=__codelineno-11-54 name=__codelineno-11-54 href=#__codelineno-11-54></a><span class=w>      </span>-<span class=w> </span><span class=nv>POSTGRES_DB</span><span class=o>=</span>kong
<a id=__codelineno-11-55 name=__codelineno-11-55 href=#__codelineno-11-55></a><span class=w>    </span>networks:
<a id=__codelineno-11-56 name=__codelineno-11-56 href=#__codelineno-11-56></a><span class=w>      </span>-<span class=w> </span>kong-net
<a id=__codelineno-11-57 name=__codelineno-11-57 href=#__codelineno-11-57></a><span class=w>    </span>volumes:
<a id=__codelineno-11-58 name=__codelineno-11-58 href=#__codelineno-11-58></a><span class=w>    </span><span class=c1># 同步时间</span>
<a id=__codelineno-11-59 name=__codelineno-11-59 href=#__codelineno-11-59></a><span class=w>      </span>-<span class=w> </span>/etc/localtime:/etc/localtime:ro
<a id=__codelineno-11-60 name=__codelineno-11-60 href=#__codelineno-11-60></a><span class=w>    </span><span class=c1># 数据库持久化目录</span>
<a id=__codelineno-11-61 name=__codelineno-11-61 href=#__codelineno-11-61></a><span class=w>      </span>-<span class=w> </span>/data/data/postgresql:/var/lib/postgresql/data
<a id=__codelineno-11-62 name=__codelineno-11-62 href=#__codelineno-11-62></a>
<a id=__codelineno-11-63 name=__codelineno-11-63 href=#__codelineno-11-63></a>networks:
<a id=__codelineno-11-64 name=__codelineno-11-64 href=#__codelineno-11-64></a><span class=w>  </span>kong-net:
<a id=__codelineno-11-65 name=__codelineno-11-65 href=#__codelineno-11-65></a><span class=w>    </span>external:<span class=w> </span><span class=nb>true</span>
</code></pre></div> <p>使用docker-compose up 命令启动服务。会发现启动时报数据库错误，这是因为kong 使用的postgres 数据还需要进行初始化才能使用。</p> <ul> <li>初始化数据库</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>     </span>--network<span class=o>=</span>kong-net<span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>     </span>-e<span class=w> </span><span class=s2>&quot;KONG_DATABASE=postgres&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>     </span>-e<span class=w> </span><span class=s2>&quot;KONG_PG_HOST=kong-database&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>     </span>-e<span class=w> </span><span class=s2>&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>     </span>kong:latest<span class=w> </span>kong<span class=w> </span>migrations<span class=w> </span>bootstrap
</code></pre></div> <p>一定要在创建数据库容器之后，并且保持数据库的Docker容器在运行状态，再执行初始化数据库，数据库初始化成功后，再次使用docker-compose up -d 启动服务就可以了。</p> <ul> <li>验证</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>curl<span class=w> </span>-i<span class=w> </span>http://localhost:8001/
</code></pre></div> <ul> <li>dashboard</li> </ul> <p>另外，也可以安装一个Kong的客户端来验证。在安装有Docker引擎的操作系统上执行如下的命令：</p> <p>1.0之后的kong-dashboard就已经不兼容了,建议使用konga</p> <h3 id=523-kong-dashboard>5.2.3 安装kong-dashboard<a class=headerlink href=#523-kong-dashboard title="Permanent link">&para;</a></h3> <ul> <li>Kong Dashboard 3.3.0 is only partially compatible with Kong 0.13. It does not support the new Service and Route objects introduced in Kong 0.13.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a># 下载镜像pgbi/kong-dashboard
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>[root@master data]# docker run --rm -p 8080:8080 pgbi/kong-dashboard start --kong-url http://10.234.2.204:30493 --basic-auth admin=kong@anchnet.com    
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>Connecting to Kong on http://10.234.2.204:30493 ...
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>What&#39;s on http://10.234.2.204:30493 isn&#39;t Kong
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>[root@master data]# kubectl get svc |grep kong
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>kong-kong-admin                     NodePort    10.104.75.151    &lt;none&gt;        8444:30493/TCP                                          52m
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>kong-kong-proxy                     NodePort    10.99.141.23     &lt;none&gt;        80:30877/TCP,443:31201/TCP                              52m
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>kong-postgresql                     ClusterIP   10.109.249.105   &lt;none&gt;        5432/TCP                                                52m
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>kong-postgresql-headless            ClusterIP   None             &lt;none&gt;        5432/TCP                                                52m
</code></pre></div> <p>通过docker安装一个Kong-Dashboard，安装完成后，通过浏览器访问：</p> <h2 id=53-kubernetes>5.3 kubernetes部署<a class=headerlink href=#53-kubernetes title="Permanent link">&para;</a></h2> <h3 id=531>5.3.1 前置条件<a class=headerlink href=#531 title="Permanent link">&para;</a></h3> <ul> <li>已有Kubernetes 1.6+环境；</li> <li>已部署helm客户端和tiller服务端（请参考：<a href=https://docs.helm.sh/using_helm/#installing-helm>https://docs.helm.sh/using_helm/#installing-helm</a>）</li> <li>在Kubernetes中创建了具备足够权限访问权限的service account；</li> <li>并通过此service account在Kubernetes部署了tiller服务端（请参考：<a href=https://docs.helm.sh/using_helm/#role-based-access-control>https://docs.helm.sh/using_helm/#role-based-access-control</a>）。</li> </ul> <h3 id=532-helm-char>5.3.2 helm char配置<a class=headerlink href=#532-helm-char title="Permanent link">&para;</a></h3> <p>下表列示了Kong chart的配置参数和默认值：</p> <table> <thead> <tr> <th style="text-align: center;">参数</th> <th style="text-align: center;">说明</th> <th style="text-align: center;">默认值</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">image.repository</td> <td style="text-align: center;">Kong image</td> <td style="text-align: center;"><code>kong</code></td> </tr> <tr> <td style="text-align: center;">image.tag</td> <td style="text-align: center;">Kong image version</td> <td style="text-align: center;"><code>0.14.1</code></td> </tr> <tr> <td style="text-align: center;">image.pullPolicy</td> <td style="text-align: center;">Image pull policy</td> <td style="text-align: center;"><code>IfNotPresent</code></td> </tr> <tr> <td style="text-align: center;">image.pullSecrets</td> <td style="text-align: center;">Image pull secrets</td> <td style="text-align: center;"><code>null</code></td> </tr> <tr> <td style="text-align: center;">replicaCount</td> <td style="text-align: center;">Kong instance count</td> <td style="text-align: center;"><code>1</code></td> </tr> <tr> <td style="text-align: center;">admin.useTLS</td> <td style="text-align: center;">Secure Admin traffic</td> <td style="text-align: center;"><code>true</code></td> </tr> <tr> <td style="text-align: center;">admin.servicePort</td> <td style="text-align: center;">TCP port on which the Kong admin service is exposed</td> <td style="text-align: center;"><code>8444</code></td> </tr> <tr> <td style="text-align: center;">admin.containerPort</td> <td style="text-align: center;">TCP port on which Kong app listens for admin traffic</td> <td style="text-align: center;"><code>8444</code></td> </tr> <tr> <td style="text-align: center;">admin.nodePort</td> <td style="text-align: center;">Node port when service type is <code>NodePort</code></td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">admin.type</td> <td style="text-align: center;">k8s service type, Options: NodePort, ClusterIP, LoadBalancer</td> <td style="text-align: center;"><code>NodePort</code></td> </tr> <tr> <td style="text-align: center;">admin.loadBalancerIP</td> <td style="text-align: center;">Will reuse an existing ingress static IP for the admin service</td> <td style="text-align: center;"><code>null</code></td> </tr> <tr> <td style="text-align: center;">admin.loadBalancerSourceRanges</td> <td style="text-align: center;">Limit admin access to CIDRs if set and service type is <code>LoadBalancer</code></td> <td style="text-align: center;"><code>[]</code></td> </tr> <tr> <td style="text-align: center;">admin.ingress.enabled</td> <td style="text-align: center;">Enable ingress resource creation (works with proxy.type=ClusterIP)</td> <td style="text-align: center;"><code>false</code></td> </tr> <tr> <td style="text-align: center;">admin.ingress.tls</td> <td style="text-align: center;">Name of secret resource, containing TLS secret</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">admin.ingress.hosts</td> <td style="text-align: center;">List of ingress hosts.</td> <td style="text-align: center;"><code>[]</code></td> </tr> <tr> <td style="text-align: center;">admin.ingress.path</td> <td style="text-align: center;">Ingress path.</td> <td style="text-align: center;"><code>/</code></td> </tr> <tr> <td style="text-align: center;">admin.ingress.annotations</td> <td style="text-align: center;">Ingress annotations. See documentation for your ingress controller for details</td> <td style="text-align: center;"><code>{}</code></td> </tr> <tr> <td style="text-align: center;">proxy.useTLS</td> <td style="text-align: center;">Secure Proxy traffic</td> <td style="text-align: center;"><code>true</code></td> </tr> <tr> <td style="text-align: center;">proxy.servicePort</td> <td style="text-align: center;">TCP port on which the Kong Proxy Service is exposed</td> <td style="text-align: center;"><code>8443</code></td> </tr> <tr> <td style="text-align: center;">proxy.containerPort</td> <td style="text-align: center;">TCP port on which the Kong app listens for Proxy traffic</td> <td style="text-align: center;"><code>8443</code></td> </tr> <tr> <td style="text-align: center;">proxy.nodePort</td> <td style="text-align: center;">Node port when service type is <code>NodePort</code></td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">proxy.type</td> <td style="text-align: center;">k8s service type. Options: NodePort, ClusterIP, LoadBalancer</td> <td style="text-align: center;"><code>NodePort</code></td> </tr> <tr> <td style="text-align: center;">proxy.loadBalancerSourceRanges</td> <td style="text-align: center;">Limit proxy access to CIDRs if set and service type is <code>LoadBalancer</code></td> <td style="text-align: center;"><code>[]</code></td> </tr> <tr> <td style="text-align: center;">proxy.loadBalancerIP</td> <td style="text-align: center;">To reuse an existing ingress static IP for the admin service</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">proxy.ingress.enabled</td> <td style="text-align: center;">Enable ingress resource creation (works with proxy.type=ClusterIP)</td> <td style="text-align: center;"><code>false</code></td> </tr> <tr> <td style="text-align: center;">proxy.ingress.tls</td> <td style="text-align: center;">Name of secret resource, containing TLS secret</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">proxy.ingress.hosts</td> <td style="text-align: center;">List of ingress hosts.</td> <td style="text-align: center;"><code>[]</code></td> </tr> <tr> <td style="text-align: center;">proxy.ingress.path</td> <td style="text-align: center;">Ingress path.</td> <td style="text-align: center;"><code>/</code></td> </tr> <tr> <td style="text-align: center;">proxy.ingress.annotations</td> <td style="text-align: center;">Ingress annotations. See documentation for your ingress controller for details</td> <td style="text-align: center;"><code>{}</code></td> </tr> <tr> <td style="text-align: center;">env</td> <td style="text-align: center;">Additional <a href=https://getkong.org/docs/latest/configuration/ >Kong configurations</a></td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">runMigrations</td> <td style="text-align: center;">Run Kong migrations job</td> <td style="text-align: center;"><code>true</code></td> </tr> <tr> <td style="text-align: center;">readinessProbe</td> <td style="text-align: center;">Kong readiness probe</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">livenessProbe</td> <td style="text-align: center;">Kong liveness probe</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">affinity</td> <td style="text-align: center;">Node/pod affinities</td> <td style="text-align: center;"></td> </tr> <tr> <td style="text-align: center;">nodeSelector</td> <td style="text-align: center;">Node labels for pod assignment</td> <td style="text-align: center;"><code>{}</code></td> </tr> <tr> <td style="text-align: center;">podAnnotations</td> <td style="text-align: center;">Annotations to add to each pod</td> <td style="text-align: center;"><code>{}</code></td> </tr> <tr> <td style="text-align: center;">resources</td> <td style="text-align: center;">Pod resource requests &amp; limits</td> <td style="text-align: center;"><code>{}</code></td> </tr> <tr> <td style="text-align: center;">tolerations</td> <td style="text-align: center;">List of node taints to tolerate</td> <td style="text-align: center;"><code>[]</code></td> </tr> </tbody> </table> <h3 id=533-chart>5.3.3 安装chart<a class=headerlink href=#533-chart title="Permanent link">&para;</a></h3> <p>启用数据库需要先安装pvc</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>---
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>kind:<span class=w> </span>PersistentVolumeClaim
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>apiVersion:<span class=w> </span>v1
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>metadata:
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>  </span>name:<span class=w> </span>data-kong-postgresql-0<span class=w> </span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>spec:
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>  </span>storageClassName:<span class=w> </span>ceph-rdb
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>  </span>accessModes:
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>  </span>-<span class=w> </span>ReadWriteOnce
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>  </span>resources:
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=w>    </span>requests:
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>      </span>storage:<span class=w> </span>4Gi
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=c1># 部署pvc</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=o>[</span>root@master<span class=w> </span>data<span class=o>]</span><span class=c1># kubectl get pvc |grep api-gateway</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>data-api-gateway-postgresql-0<span class=w>           </span>Bound<span class=w>    </span>pvc-d280166c-c03d-11e9-a45a-facf8ddba000<span class=w>   </span>8Gi<span class=w>        </span>RWO<span class=w>            </span>ceph-rdb<span class=w>       </span>11s
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>helm<span class=w> </span>fetch<span class=w> </span>stable/kong<span class=w> </span>--version<span class=w> </span><span class=m>0</span>.13.0
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=o>[</span>root@master<span class=w> </span>kong-deploy<span class=o>]</span><span class=c1># helm install -n api-gateway kong/</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>NAME:<span class=w>   </span>api-gateway
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>LAST<span class=w> </span>DEPLOYED:<span class=w> </span>Fri<span class=w> </span>Aug<span class=w> </span><span class=m>16</span><span class=w> </span><span class=m>23</span>:53:37<span class=w> </span><span class=m>2019</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>NAMESPACE:<span class=w> </span>default
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>STATUS:<span class=w> </span>DEPLOYED
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>RESOURCES:
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=o>==</span>&gt;<span class=w> </span>v1/Job
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>NAME<span class=w>                              </span>COMPLETIONS<span class=w>  </span>DURATION<span class=w>  </span>AGE
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>api-gateway-kong-init-migrations<span class=w>  </span><span class=m>0</span>/1<span class=w>          </span>0s<span class=w>        </span><span class=nv>0s</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=o>==</span>&gt;<span class=w> </span>v1/Pod<span class=o>(</span>related<span class=o>)</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>NAME<span class=w>                                    </span>READY<span class=w>  </span>STATUS<span class=w>    </span>RESTARTS<span class=w>  </span>AGE
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>api-gateway-kong-79f697ff7c-bcr7m<span class=w>       </span><span class=m>0</span>/1<span class=w>    </span>Init:0/1<span class=w>  </span><span class=m>0</span><span class=w>         </span>0s
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>api-gateway-kong-init-migrations-hxgd6<span class=w>  </span><span class=m>0</span>/1<span class=w>    </span>Init:0/1<span class=w>  </span><span class=m>0</span><span class=w>         </span>0s
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>api-gateway-postgresql-0<span class=w>                </span><span class=m>0</span>/1<span class=w>    </span>Init:0/1<span class=w>  </span><span class=m>0</span><span class=w>         </span><span class=nv>0s</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=o>==</span>&gt;<span class=w> </span>v1/Secret
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>NAME<span class=w>                    </span>TYPE<span class=w>    </span>DATA<span class=w>  </span>AGE
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>api-gateway-postgresql<span class=w>  </span>Opaque<span class=w>  </span><span class=m>1</span><span class=w>     </span><span class=nv>0s</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=o>==</span>&gt;<span class=w> </span>v1/Service
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>NAME<span class=w>                             </span>TYPE<span class=w>       </span>CLUSTER-IP<span class=w>      </span>EXTERNAL-IP<span class=w>  </span>PORT<span class=o>(</span>S<span class=o>)</span><span class=w>                     </span>AGE
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>api-gateway-kong-admin<span class=w>           </span>NodePort<span class=w>   </span><span class=m>10</span>.100.226.67<span class=w>   </span>&lt;none&gt;<span class=w>       </span><span class=m>8444</span>:31466/TCP<span class=w>              </span>0s
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>api-gateway-kong-proxy<span class=w>           </span>NodePort<span class=w>   </span><span class=m>10</span>.109.4.127<span class=w>    </span>&lt;none&gt;<span class=w>       </span><span class=m>80</span>:32287/TCP,443:32742/TCP<span class=w>  </span>0s
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a>api-gateway-postgresql<span class=w>           </span>ClusterIP<span class=w>  </span><span class=m>10</span>.102.197.253<span class=w>  </span>&lt;none&gt;<span class=w>       </span><span class=m>5432</span>/TCP<span class=w>                    </span>0s
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a>api-gateway-postgresql-headless<span class=w>  </span>ClusterIP<span class=w>  </span>None<span class=w>            </span>&lt;none&gt;<span class=w>       </span><span class=m>5432</span>/TCP<span class=w>                    </span><span class=nv>0s</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=o>==</span>&gt;<span class=w> </span>v1beta2/Deployment
<a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a>NAME<span class=w>              </span>READY<span class=w>  </span>UP-TO-DATE<span class=w>  </span>AVAILABLE<span class=w>  </span>AGE
<a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a>api-gateway-kong<span class=w>  </span><span class=m>0</span>/1<span class=w>    </span><span class=m>1</span><span class=w>           </span><span class=m>0</span><span class=w>          </span><span class=nv>0s</span>
<a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a>
<a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=o>==</span>&gt;<span class=w> </span>v1beta2/StatefulSet
<a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a>NAME<span class=w>                    </span>READY<span class=w>  </span>AGE
<a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a>api-gateway-postgresql<span class=w>  </span><span class=m>0</span>/1<span class=w>    </span>0s
<a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a>
<a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a>
<a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a>NOTES:
<a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a><span class=m>1</span>.<span class=w> </span>Kong<span class=w> </span>Admin<span class=w> </span>can<span class=w> </span>be<span class=w> </span>accessed<span class=w> </span>inside<span class=w> </span>the<span class=w> </span>cluster<span class=w> </span>using:
<a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a><span class=w>     </span><span class=nv>DNS</span><span class=o>=</span>api-gateway-kong-admin.default.svc.cluster.local
<a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a><span class=w>     </span><span class=nv>PORT</span><span class=o>=</span><span class=m>8444</span>
<a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a>
<a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a>To<span class=w> </span>connect<span class=w> </span>from<span class=w> </span>outside<span class=w> </span>the<span class=w> </span>K8s<span class=w> </span>cluster:
<a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a><span class=w>     </span><span class=nv>HOST</span><span class=o>=</span><span class=k>$(</span>kubectl<span class=w> </span>get<span class=w> </span>nodes<span class=w> </span>--namespace<span class=w> </span>default<span class=w> </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0].status.addresses[0].address}&#39;</span><span class=k>)</span>
<a id=__codelineno-16-49 name=__codelineno-16-49 href=#__codelineno-16-49></a><span class=w>     </span><span class=nv>PORT</span><span class=o>=</span><span class=k>$(</span>kubectl<span class=w> </span>get<span class=w> </span>svc<span class=w> </span>--namespace<span class=w> </span>default<span class=w> </span>api-gateway-kong-admin<span class=w> </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.spec.ports[0].nodePort}&#39;</span><span class=k>)</span>
<a id=__codelineno-16-50 name=__codelineno-16-50 href=#__codelineno-16-50></a>
<a id=__codelineno-16-51 name=__codelineno-16-51 href=#__codelineno-16-51></a>
<a id=__codelineno-16-52 name=__codelineno-16-52 href=#__codelineno-16-52></a><span class=m>2</span>.<span class=w> </span>Kong<span class=w> </span>Proxy<span class=w> </span>can<span class=w> </span>be<span class=w> </span>accessed<span class=w> </span>inside<span class=w> </span>the<span class=w> </span>cluster<span class=w> </span>using:
<a id=__codelineno-16-53 name=__codelineno-16-53 href=#__codelineno-16-53></a><span class=w>     </span><span class=nv>DNS</span><span class=o>=</span>api-gateway-kong-proxy.default.svc.cluster.localPORT<span class=o>=</span>443To<span class=w> </span>connect<span class=w> </span>from<span class=w> </span>outside<span class=w> </span>the<span class=w> </span>K8s<span class=w> </span>cluster:
<a id=__codelineno-16-54 name=__codelineno-16-54 href=#__codelineno-16-54></a><span class=w>     </span><span class=nv>HOST</span><span class=o>=</span><span class=k>$(</span>kubectl<span class=w> </span>get<span class=w> </span>nodes<span class=w> </span>--namespace<span class=w> </span>default<span class=w> </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.items[0].status.addresses[0].address}&#39;</span><span class=k>)</span>
<a id=__codelineno-16-55 name=__codelineno-16-55 href=#__codelineno-16-55></a><span class=w>     </span><span class=nv>PORT</span><span class=o>=</span><span class=k>$(</span>kubectl<span class=w> </span>get<span class=w> </span>svc<span class=w> </span>--namespace<span class=w> </span>default<span class=w> </span>api-gateway-kong-proxy<span class=w> </span>-o<span class=w> </span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.spec.ports[0].nodePort}&#39;</span><span class=k>)</span>
</code></pre></div> <h3 id=534-kong>5.3.4 验证Kong(命令行)<a class=headerlink href=#534-kong title="Permanent link">&para;</a></h3> <p>通过执行下面的命令，进入Kong的容器：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>[root@master kong-deploy]# kubectl exec -it api-gateway-kong-79f697ff7c-bcr7m /bin/sh
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>/ # netstat -lntup
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>Active Internet connections (only servers)
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>tcp        0      0 0.0.0.0:8443            0.0.0.0:*               LISTEN      -
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>tcp        0      0 0.0.0.0:8444            0.0.0.0:*               LISTEN      -
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      -
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>/ # curl -k https://localhost:8444
</code></pre></div> <p>并在kong中执行如下的命令：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>curl -k http://localhost:8444
</code></pre></div> <p>如果kong正常运行的话，应该会返回一些内容。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=o>[</span>root@master<span class=w> </span>~<span class=o>]</span><span class=c1># kubectl get all |grep api-gateway</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>pod/api-gateway-kong-8cf4ddcbf-qb87c<span class=w>                          </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>0</span><span class=w>          </span>15h
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>pod/api-gateway-kong-init-migrations-fsfqb<span class=w>                    </span><span class=m>0</span>/1<span class=w>     </span>Completed<span class=w>   </span><span class=m>0</span><span class=w>          </span>15h
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>pod/api-gateway-postgresql-0<span class=w>                                  </span><span class=m>1</span>/1<span class=w>     </span>Running<span class=w>     </span><span class=m>0</span><span class=w>          </span>15h
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>service/api-gateway-kong-admin<span class=w>              </span>NodePort<span class=w>    </span><span class=m>10</span>.103.90.21<span class=w>     </span>&lt;none&gt;<span class=w>        </span><span class=m>8444</span>:30840/TCP<span class=w>                                          </span>15h
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>service/api-gateway-kong-proxy<span class=w>              </span>NodePort<span class=w>    </span><span class=m>10</span>.96.32.21<span class=w>      </span>&lt;none&gt;<span class=w>        </span><span class=m>80</span>:32582/TCP,443:31941/TCP<span class=w>                              </span>15h
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>service/api-gateway-postgresql<span class=w>              </span>ClusterIP<span class=w>   </span><span class=m>10</span>.109.28.2<span class=w>      </span>&lt;none&gt;<span class=w>        </span><span class=m>5432</span>/TCP<span class=w>                                                </span>15h
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>service/api-gateway-postgresql-headless<span class=w>     </span>ClusterIP<span class=w>   </span>None<span class=w>             </span>&lt;none&gt;<span class=w>        </span><span class=m>5432</span>/TCP<span class=w>                                                </span>15h
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>deployment.apps/api-gateway-kong<span class=w>                         </span><span class=m>1</span>/1<span class=w>     </span><span class=m>1</span><span class=w>            </span><span class=m>1</span><span class=w>           </span>15h
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>replicaset.apps/api-gateway-kong-8cf4ddcbf<span class=w>                          </span><span class=m>1</span><span class=w>         </span><span class=m>1</span><span class=w>         </span><span class=m>1</span><span class=w>       </span>15h
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>statefulset.apps/api-gateway-postgresql<span class=w>           </span><span class=m>1</span>/1<span class=w>     </span>15h
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>job.batch/api-gateway-kong-init-migrations<span class=w>     </span><span class=m>1</span>/1<span class=w>           </span>51s<span class=w>        </span>15h
</code></pre></div> <p>通过浏览器查看</p> <p><img alt=image-20190817000041524 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817000041524.png"></p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=o>{</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>    </span><span class=s2>&quot;plugins&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>        </span><span class=s2>&quot;enabled_in_cluster&quot;</span>:<span class=w> </span><span class=o>[]</span>,
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>        </span><span class=s2>&quot;available_on_server&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>            </span><span class=s2>&quot;correlation-id&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>            </span><span class=s2>&quot;pre-function&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>            </span><span class=s2>&quot;cors&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>            </span><span class=s2>&quot;ldap-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>            </span><span class=s2>&quot;loggly&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=w>            </span><span class=s2>&quot;hmac-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>            </span><span class=s2>&quot;zipkin&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>            </span><span class=s2>&quot;request-size-limiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=w>            </span><span class=s2>&quot;azure-functions&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=w>            </span><span class=s2>&quot;request-transformer&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>            </span><span class=s2>&quot;oauth2&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a><span class=w>            </span><span class=s2>&quot;response-transformer&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a><span class=w>            </span><span class=s2>&quot;ip-restriction&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>            </span><span class=s2>&quot;statsd&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>            </span><span class=s2>&quot;jwt&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=w>            </span><span class=s2>&quot;proxy-cache&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a><span class=w>            </span><span class=s2>&quot;basic-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=w>            </span><span class=s2>&quot;key-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a><span class=w>            </span><span class=s2>&quot;http-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a><span class=w>            </span><span class=s2>&quot;datadog&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a><span class=w>            </span><span class=s2>&quot;tcp-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a><span class=w>            </span><span class=s2>&quot;post-function&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a><span class=w>            </span><span class=s2>&quot;prometheus&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a><span class=w>            </span><span class=s2>&quot;acl&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a><span class=w>            </span><span class=s2>&quot;kubernetes-sidecar-injector&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a><span class=w>            </span><span class=s2>&quot;syslog&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a><span class=w>            </span><span class=s2>&quot;file-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a><span class=w>            </span><span class=s2>&quot;udp-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a><span class=w>            </span><span class=s2>&quot;response-ratelimiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-34 name=__codelineno-20-34 href=#__codelineno-20-34></a><span class=w>            </span><span class=s2>&quot;aws-lambda&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-35 name=__codelineno-20-35 href=#__codelineno-20-35></a><span class=w>            </span><span class=s2>&quot;bot-detection&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-36 name=__codelineno-20-36 href=#__codelineno-20-36></a><span class=w>            </span><span class=s2>&quot;rate-limiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-37 name=__codelineno-20-37 href=#__codelineno-20-37></a><span class=w>            </span><span class=s2>&quot;request-termination&quot;</span>:<span class=w> </span><span class=nb>true</span>
<a id=__codelineno-20-38 name=__codelineno-20-38 href=#__codelineno-20-38></a><span class=w>        </span><span class=o>}</span>
<a id=__codelineno-20-39 name=__codelineno-20-39 href=#__codelineno-20-39></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-20-40 name=__codelineno-20-40 href=#__codelineno-20-40></a><span class=w>    </span><span class=s2>&quot;tagline&quot;</span>:<span class=w> </span><span class=s2>&quot;Welcome to kong&quot;</span>,
<a id=__codelineno-20-41 name=__codelineno-20-41 href=#__codelineno-20-41></a><span class=w>    </span><span class=s2>&quot;configuration&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-42 name=__codelineno-20-42 href=#__codelineno-20-42></a><span class=w>        </span><span class=s2>&quot;error_default_type&quot;</span>:<span class=w> </span><span class=s2>&quot;text/plain&quot;</span>,
<a id=__codelineno-20-43 name=__codelineno-20-43 href=#__codelineno-20-43></a><span class=w>        </span><span class=s2>&quot;admin_listen&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-44 name=__codelineno-20-44 href=#__codelineno-20-44></a><span class=w>            </span><span class=s2>&quot;0.0.0.0:8444 ssl&quot;</span>
<a id=__codelineno-20-45 name=__codelineno-20-45 href=#__codelineno-20-45></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-46 name=__codelineno-20-46 href=#__codelineno-20-46></a><span class=w>        </span><span class=s2>&quot;proxy_access_log&quot;</span>:<span class=w> </span><span class=s2>&quot;/dev/stdout&quot;</span>,
<a id=__codelineno-20-47 name=__codelineno-20-47 href=#__codelineno-20-47></a><span class=w>        </span><span class=s2>&quot;trusted_ips&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-48 name=__codelineno-20-48 href=#__codelineno-20-48></a><span class=w>        </span><span class=s2>&quot;prefix&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong&quot;</span>,
<a id=__codelineno-20-49 name=__codelineno-20-49 href=#__codelineno-20-49></a><span class=w>        </span><span class=s2>&quot;loaded_plugins&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-50 name=__codelineno-20-50 href=#__codelineno-20-50></a><span class=w>            </span><span class=s2>&quot;correlation-id&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-51 name=__codelineno-20-51 href=#__codelineno-20-51></a><span class=w>            </span><span class=s2>&quot;pre-function&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-52 name=__codelineno-20-52 href=#__codelineno-20-52></a><span class=w>            </span><span class=s2>&quot;cors&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-53 name=__codelineno-20-53 href=#__codelineno-20-53></a><span class=w>            </span><span class=s2>&quot;rate-limiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-54 name=__codelineno-20-54 href=#__codelineno-20-54></a><span class=w>            </span><span class=s2>&quot;loggly&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-55 name=__codelineno-20-55 href=#__codelineno-20-55></a><span class=w>            </span><span class=s2>&quot;hmac-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-56 name=__codelineno-20-56 href=#__codelineno-20-56></a><span class=w>            </span><span class=s2>&quot;zipkin&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-57 name=__codelineno-20-57 href=#__codelineno-20-57></a><span class=w>            </span><span class=s2>&quot;bot-detection&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-58 name=__codelineno-20-58 href=#__codelineno-20-58></a><span class=w>            </span><span class=s2>&quot;azure-functions&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-59 name=__codelineno-20-59 href=#__codelineno-20-59></a><span class=w>            </span><span class=s2>&quot;request-transformer&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-60 name=__codelineno-20-60 href=#__codelineno-20-60></a><span class=w>            </span><span class=s2>&quot;oauth2&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-61 name=__codelineno-20-61 href=#__codelineno-20-61></a><span class=w>            </span><span class=s2>&quot;response-transformer&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-62 name=__codelineno-20-62 href=#__codelineno-20-62></a><span class=w>            </span><span class=s2>&quot;syslog&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-63 name=__codelineno-20-63 href=#__codelineno-20-63></a><span class=w>            </span><span class=s2>&quot;statsd&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-64 name=__codelineno-20-64 href=#__codelineno-20-64></a><span class=w>            </span><span class=s2>&quot;jwt&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-65 name=__codelineno-20-65 href=#__codelineno-20-65></a><span class=w>            </span><span class=s2>&quot;proxy-cache&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-66 name=__codelineno-20-66 href=#__codelineno-20-66></a><span class=w>            </span><span class=s2>&quot;basic-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-67 name=__codelineno-20-67 href=#__codelineno-20-67></a><span class=w>            </span><span class=s2>&quot;key-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-68 name=__codelineno-20-68 href=#__codelineno-20-68></a><span class=w>            </span><span class=s2>&quot;http-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-69 name=__codelineno-20-69 href=#__codelineno-20-69></a><span class=w>            </span><span class=s2>&quot;datadog&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-70 name=__codelineno-20-70 href=#__codelineno-20-70></a><span class=w>            </span><span class=s2>&quot;tcp-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-71 name=__codelineno-20-71 href=#__codelineno-20-71></a><span class=w>            </span><span class=s2>&quot;post-function&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-72 name=__codelineno-20-72 href=#__codelineno-20-72></a><span class=w>            </span><span class=s2>&quot;ldap-auth&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-73 name=__codelineno-20-73 href=#__codelineno-20-73></a><span class=w>            </span><span class=s2>&quot;acl&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-74 name=__codelineno-20-74 href=#__codelineno-20-74></a><span class=w>            </span><span class=s2>&quot;kubernetes-sidecar-injector&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-75 name=__codelineno-20-75 href=#__codelineno-20-75></a><span class=w>            </span><span class=s2>&quot;ip-restriction&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-76 name=__codelineno-20-76 href=#__codelineno-20-76></a><span class=w>            </span><span class=s2>&quot;file-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-77 name=__codelineno-20-77 href=#__codelineno-20-77></a><span class=w>            </span><span class=s2>&quot;udp-log&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-78 name=__codelineno-20-78 href=#__codelineno-20-78></a><span class=w>            </span><span class=s2>&quot;response-ratelimiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-79 name=__codelineno-20-79 href=#__codelineno-20-79></a><span class=w>            </span><span class=s2>&quot;aws-lambda&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-80 name=__codelineno-20-80 href=#__codelineno-20-80></a><span class=w>            </span><span class=s2>&quot;prometheus&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-81 name=__codelineno-20-81 href=#__codelineno-20-81></a><span class=w>            </span><span class=s2>&quot;request-size-limiting&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-82 name=__codelineno-20-82 href=#__codelineno-20-82></a><span class=w>            </span><span class=s2>&quot;request-termination&quot;</span>:<span class=w> </span><span class=nb>true</span>
<a id=__codelineno-20-83 name=__codelineno-20-83 href=#__codelineno-20-83></a><span class=w>        </span><span class=o>}</span>,
<a id=__codelineno-20-84 name=__codelineno-20-84 href=#__codelineno-20-84></a><span class=w>        </span><span class=s2>&quot;cassandra_username&quot;</span>:<span class=w> </span><span class=s2>&quot;kong&quot;</span>,
<a id=__codelineno-20-85 name=__codelineno-20-85 href=#__codelineno-20-85></a><span class=w>        </span><span class=s2>&quot;ssl_cert_key&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.key&quot;</span>,
<a id=__codelineno-20-86 name=__codelineno-20-86 href=#__codelineno-20-86></a><span class=w>        </span><span class=s2>&quot;admin_ssl_cert_key&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/admin-kong-default.key&quot;</span>,
<a id=__codelineno-20-87 name=__codelineno-20-87 href=#__codelineno-20-87></a><span class=w>        </span><span class=s2>&quot;dns_resolver&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-88 name=__codelineno-20-88 href=#__codelineno-20-88></a><span class=w>        </span><span class=s2>&quot;pg_user&quot;</span>:<span class=w> </span><span class=s2>&quot;kong&quot;</span>,
<a id=__codelineno-20-89 name=__codelineno-20-89 href=#__codelineno-20-89></a><span class=w>        </span><span class=s2>&quot;pg_password&quot;</span>:<span class=w> </span><span class=s2>&quot;******&quot;</span>,
<a id=__codelineno-20-90 name=__codelineno-20-90 href=#__codelineno-20-90></a><span class=w>        </span><span class=s2>&quot;cassandra_data_centers&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-91 name=__codelineno-20-91 href=#__codelineno-20-91></a><span class=w>            </span><span class=s2>&quot;dc1:2&quot;</span>,
<a id=__codelineno-20-92 name=__codelineno-20-92 href=#__codelineno-20-92></a><span class=w>            </span><span class=s2>&quot;dc2:3&quot;</span>
<a id=__codelineno-20-93 name=__codelineno-20-93 href=#__codelineno-20-93></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-94 name=__codelineno-20-94 href=#__codelineno-20-94></a><span class=w>        </span><span class=s2>&quot;nginx_admin_directives&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-95 name=__codelineno-20-95 href=#__codelineno-20-95></a><span class=w>        </span><span class=s2>&quot;nginx_http_directives&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-96 name=__codelineno-20-96 href=#__codelineno-20-96></a><span class=w>            </span><span class=o>{</span>
<a id=__codelineno-20-97 name=__codelineno-20-97 href=#__codelineno-20-97></a><span class=w>                </span><span class=s2>&quot;value&quot;</span>:<span class=w> </span><span class=s2>&quot;prometheus_metrics 5m&quot;</span>,
<a id=__codelineno-20-98 name=__codelineno-20-98 href=#__codelineno-20-98></a><span class=w>                </span><span class=s2>&quot;name&quot;</span>:<span class=w> </span><span class=s2>&quot;lua_shared_dict&quot;</span>
<a id=__codelineno-20-99 name=__codelineno-20-99 href=#__codelineno-20-99></a><span class=w>            </span><span class=o>}</span>
<a id=__codelineno-20-100 name=__codelineno-20-100 href=#__codelineno-20-100></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-101 name=__codelineno-20-101 href=#__codelineno-20-101></a><span class=w>        </span><span class=s2>&quot;pg_host&quot;</span>:<span class=w> </span><span class=s2>&quot;api-gateway-postgresql&quot;</span>,
<a id=__codelineno-20-102 name=__codelineno-20-102 href=#__codelineno-20-102></a><span class=w>        </span><span class=s2>&quot;nginx_acc_logs&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/logs/access.log&quot;</span>,
<a id=__codelineno-20-103 name=__codelineno-20-103 href=#__codelineno-20-103></a><span class=w>        </span><span class=s2>&quot;pg_semaphore_timeout&quot;</span>:<span class=w> </span><span class=m>60000</span>,
<a id=__codelineno-20-104 name=__codelineno-20-104 href=#__codelineno-20-104></a><span class=w>        </span><span class=s2>&quot;proxy_listen&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-105 name=__codelineno-20-105 href=#__codelineno-20-105></a><span class=w>            </span><span class=s2>&quot;0.0.0.0:8000&quot;</span>,
<a id=__codelineno-20-106 name=__codelineno-20-106 href=#__codelineno-20-106></a><span class=w>            </span><span class=s2>&quot;0.0.0.0:8443 ssl&quot;</span>
<a id=__codelineno-20-107 name=__codelineno-20-107 href=#__codelineno-20-107></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-108 name=__codelineno-20-108 href=#__codelineno-20-108></a><span class=w>        </span><span class=s2>&quot;client_ssl_cert_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.crt&quot;</span>,
<a id=__codelineno-20-109 name=__codelineno-20-109 href=#__codelineno-20-109></a><span class=w>        </span><span class=s2>&quot;cassandra_ssl&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-110 name=__codelineno-20-110 href=#__codelineno-20-110></a><span class=w>        </span><span class=s2>&quot;db_update_frequency&quot;</span>:<span class=w> </span><span class=m>5</span>,
<a id=__codelineno-20-111 name=__codelineno-20-111 href=#__codelineno-20-111></a><span class=w>        </span><span class=s2>&quot;db_update_propagation&quot;</span>:<span class=w> </span><span class=m>0</span>,
<a id=__codelineno-20-112 name=__codelineno-20-112 href=#__codelineno-20-112></a><span class=w>        </span><span class=s2>&quot;stream_listen&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-113 name=__codelineno-20-113 href=#__codelineno-20-113></a><span class=w>            </span><span class=s2>&quot;off&quot;</span>
<a id=__codelineno-20-114 name=__codelineno-20-114 href=#__codelineno-20-114></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-115 name=__codelineno-20-115 href=#__codelineno-20-115></a><span class=w>        </span><span class=s2>&quot;nginx_err_logs&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/logs/error.log&quot;</span>,
<a id=__codelineno-20-116 name=__codelineno-20-116 href=#__codelineno-20-116></a><span class=w>        </span><span class=s2>&quot;cassandra_port&quot;</span>:<span class=w> </span><span class=m>9042</span>,
<a id=__codelineno-20-117 name=__codelineno-20-117 href=#__codelineno-20-117></a><span class=w>        </span><span class=s2>&quot;dns_order&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-118 name=__codelineno-20-118 href=#__codelineno-20-118></a><span class=w>            </span><span class=s2>&quot;LAST&quot;</span>,
<a id=__codelineno-20-119 name=__codelineno-20-119 href=#__codelineno-20-119></a><span class=w>            </span><span class=s2>&quot;SRV&quot;</span>,
<a id=__codelineno-20-120 name=__codelineno-20-120 href=#__codelineno-20-120></a><span class=w>            </span><span class=s2>&quot;A&quot;</span>,
<a id=__codelineno-20-121 name=__codelineno-20-121 href=#__codelineno-20-121></a><span class=w>            </span><span class=s2>&quot;CNAME&quot;</span>
<a id=__codelineno-20-122 name=__codelineno-20-122 href=#__codelineno-20-122></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-123 name=__codelineno-20-123 href=#__codelineno-20-123></a><span class=w>        </span><span class=s2>&quot;dns_error_ttl&quot;</span>:<span class=w> </span><span class=m>1</span>,
<a id=__codelineno-20-124 name=__codelineno-20-124 href=#__codelineno-20-124></a><span class=w>        </span><span class=s2>&quot;headers&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-125 name=__codelineno-20-125 href=#__codelineno-20-125></a><span class=w>            </span><span class=s2>&quot;server_tokens&quot;</span>,
<a id=__codelineno-20-126 name=__codelineno-20-126 href=#__codelineno-20-126></a><span class=w>            </span><span class=s2>&quot;latency_tokens&quot;</span>
<a id=__codelineno-20-127 name=__codelineno-20-127 href=#__codelineno-20-127></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-128 name=__codelineno-20-128 href=#__codelineno-20-128></a><span class=w>        </span><span class=s2>&quot;cassandra_lb_policy&quot;</span>:<span class=w> </span><span class=s2>&quot;RequestRoundRobin&quot;</span>,
<a id=__codelineno-20-129 name=__codelineno-20-129 href=#__codelineno-20-129></a><span class=w>        </span><span class=s2>&quot;nginx_optimizations&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-130 name=__codelineno-20-130 href=#__codelineno-20-130></a><span class=w>        </span><span class=s2>&quot;pg_timeout&quot;</span>:<span class=w> </span><span class=m>5000</span>,
<a id=__codelineno-20-131 name=__codelineno-20-131 href=#__codelineno-20-131></a><span class=w>        </span><span class=s2>&quot;database&quot;</span>:<span class=w> </span><span class=s2>&quot;postgres&quot;</span>,
<a id=__codelineno-20-132 name=__codelineno-20-132 href=#__codelineno-20-132></a><span class=w>        </span><span class=s2>&quot;pg_database&quot;</span>:<span class=w> </span><span class=s2>&quot;kong&quot;</span>,
<a id=__codelineno-20-133 name=__codelineno-20-133 href=#__codelineno-20-133></a><span class=w>        </span><span class=s2>&quot;nginx_worker_processes&quot;</span>:<span class=w> </span><span class=s2>&quot;auto&quot;</span>,
<a id=__codelineno-20-134 name=__codelineno-20-134 href=#__codelineno-20-134></a><span class=w>        </span><span class=s2>&quot;lua_package_cpath&quot;</span>:<span class=w> </span><span class=s2>&quot;&quot;</span>,
<a id=__codelineno-20-135 name=__codelineno-20-135 href=#__codelineno-20-135></a><span class=w>        </span><span class=s2>&quot;admin_ssl_cert&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/admin-kong-default.crt&quot;</span>,
<a id=__codelineno-20-136 name=__codelineno-20-136 href=#__codelineno-20-136></a><span class=w>        </span><span class=s2>&quot;admin_acc_logs&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/logs/admin_access.log&quot;</span>,
<a id=__codelineno-20-137 name=__codelineno-20-137 href=#__codelineno-20-137></a><span class=w>        </span><span class=s2>&quot;real_ip_header&quot;</span>:<span class=w> </span><span class=s2>&quot;X-Real-IP&quot;</span>,
<a id=__codelineno-20-138 name=__codelineno-20-138 href=#__codelineno-20-138></a><span class=w>        </span><span class=s2>&quot;ssl_cert_key_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.key&quot;</span>,
<a id=__codelineno-20-139 name=__codelineno-20-139 href=#__codelineno-20-139></a><span class=w>        </span><span class=s2>&quot;lua_package_path&quot;</span>:<span class=w> </span><span class=s2>&quot;./?.lua;./?/init.lua;&quot;</span>,
<a id=__codelineno-20-140 name=__codelineno-20-140 href=#__codelineno-20-140></a><span class=w>        </span><span class=s2>&quot;nginx_pid&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/pids/nginx.pid&quot;</span>,
<a id=__codelineno-20-141 name=__codelineno-20-141 href=#__codelineno-20-141></a><span class=w>        </span><span class=s2>&quot;upstream_keepalive&quot;</span>:<span class=w> </span><span class=m>60</span>,
<a id=__codelineno-20-142 name=__codelineno-20-142 href=#__codelineno-20-142></a><span class=w>        </span><span class=s2>&quot;nginx_conf&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/nginx.conf&quot;</span>,
<a id=__codelineno-20-143 name=__codelineno-20-143 href=#__codelineno-20-143></a><span class=w>        </span><span class=s2>&quot;router_consistency&quot;</span>:<span class=w> </span><span class=s2>&quot;strict&quot;</span>,
<a id=__codelineno-20-144 name=__codelineno-20-144 href=#__codelineno-20-144></a><span class=w>        </span><span class=s2>&quot;dns_no_sync&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-145 name=__codelineno-20-145 href=#__codelineno-20-145></a><span class=w>        </span><span class=s2>&quot;origins&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-146 name=__codelineno-20-146 href=#__codelineno-20-146></a><span class=w>        </span><span class=s2>&quot;admin_access_log&quot;</span>:<span class=w> </span><span class=s2>&quot;/dev/stdout&quot;</span>,
<a id=__codelineno-20-147 name=__codelineno-20-147 href=#__codelineno-20-147></a><span class=w>        </span><span class=s2>&quot;admin_ssl_cert_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/admin-kong-default.crt&quot;</span>,
<a id=__codelineno-20-148 name=__codelineno-20-148 href=#__codelineno-20-148></a><span class=w>        </span><span class=s2>&quot;client_ssl&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-149 name=__codelineno-20-149 href=#__codelineno-20-149></a><span class=w>        </span><span class=s2>&quot;proxy_listeners&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-150 name=__codelineno-20-150 href=#__codelineno-20-150></a><span class=w>            </span><span class=o>{</span>
<a id=__codelineno-20-151 name=__codelineno-20-151 href=#__codelineno-20-151></a><span class=w>                </span><span class=s2>&quot;transparent&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-152 name=__codelineno-20-152 href=#__codelineno-20-152></a><span class=w>                </span><span class=s2>&quot;ssl&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-153 name=__codelineno-20-153 href=#__codelineno-20-153></a><span class=w>                </span><span class=s2>&quot;ip&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0&quot;</span>,
<a id=__codelineno-20-154 name=__codelineno-20-154 href=#__codelineno-20-154></a><span class=w>                </span><span class=s2>&quot;proxy_protocol&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-155 name=__codelineno-20-155 href=#__codelineno-20-155></a><span class=w>                </span><span class=s2>&quot;port&quot;</span>:<span class=w> </span><span class=m>8000</span>,
<a id=__codelineno-20-156 name=__codelineno-20-156 href=#__codelineno-20-156></a><span class=w>                </span><span class=s2>&quot;http2&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-157 name=__codelineno-20-157 href=#__codelineno-20-157></a><span class=w>                </span><span class=s2>&quot;listener&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0:8000&quot;</span>
<a id=__codelineno-20-158 name=__codelineno-20-158 href=#__codelineno-20-158></a><span class=w>            </span><span class=o>}</span>,
<a id=__codelineno-20-159 name=__codelineno-20-159 href=#__codelineno-20-159></a><span class=w>            </span><span class=o>{</span>
<a id=__codelineno-20-160 name=__codelineno-20-160 href=#__codelineno-20-160></a><span class=w>                </span><span class=s2>&quot;transparent&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-161 name=__codelineno-20-161 href=#__codelineno-20-161></a><span class=w>                </span><span class=s2>&quot;ssl&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-162 name=__codelineno-20-162 href=#__codelineno-20-162></a><span class=w>                </span><span class=s2>&quot;ip&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0&quot;</span>,
<a id=__codelineno-20-163 name=__codelineno-20-163 href=#__codelineno-20-163></a><span class=w>                </span><span class=s2>&quot;proxy_protocol&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-164 name=__codelineno-20-164 href=#__codelineno-20-164></a><span class=w>                </span><span class=s2>&quot;port&quot;</span>:<span class=w> </span><span class=m>8443</span>,
<a id=__codelineno-20-165 name=__codelineno-20-165 href=#__codelineno-20-165></a><span class=w>                </span><span class=s2>&quot;http2&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-166 name=__codelineno-20-166 href=#__codelineno-20-166></a><span class=w>                </span><span class=s2>&quot;listener&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0:8443 ssl&quot;</span>
<a id=__codelineno-20-167 name=__codelineno-20-167 href=#__codelineno-20-167></a><span class=w>            </span><span class=o>}</span>
<a id=__codelineno-20-168 name=__codelineno-20-168 href=#__codelineno-20-168></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-169 name=__codelineno-20-169 href=#__codelineno-20-169></a><span class=w>        </span><span class=s2>&quot;proxy_ssl_enabled&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-170 name=__codelineno-20-170 href=#__codelineno-20-170></a><span class=w>        </span><span class=s2>&quot;stream_listeners&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-171 name=__codelineno-20-171 href=#__codelineno-20-171></a><span class=w>        </span><span class=s2>&quot;db_cache_warmup_entities&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-172 name=__codelineno-20-172 href=#__codelineno-20-172></a><span class=w>            </span><span class=s2>&quot;services&quot;</span>,
<a id=__codelineno-20-173 name=__codelineno-20-173 href=#__codelineno-20-173></a><span class=w>            </span><span class=s2>&quot;plugins&quot;</span>
<a id=__codelineno-20-174 name=__codelineno-20-174 href=#__codelineno-20-174></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-175 name=__codelineno-20-175 href=#__codelineno-20-175></a><span class=w>        </span><span class=s2>&quot;enabled_headers&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-176 name=__codelineno-20-176 href=#__codelineno-20-176></a><span class=w>            </span><span class=s2>&quot;latency_tokens&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-177 name=__codelineno-20-177 href=#__codelineno-20-177></a><span class=w>            </span><span class=s2>&quot;X-Kong-Proxy-Latency&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-178 name=__codelineno-20-178 href=#__codelineno-20-178></a><span class=w>            </span><span class=s2>&quot;Via&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-179 name=__codelineno-20-179 href=#__codelineno-20-179></a><span class=w>            </span><span class=s2>&quot;server_tokens&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-180 name=__codelineno-20-180 href=#__codelineno-20-180></a><span class=w>            </span><span class=s2>&quot;Server&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-181 name=__codelineno-20-181 href=#__codelineno-20-181></a><span class=w>            </span><span class=s2>&quot;X-Kong-Upstream-Latency&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-182 name=__codelineno-20-182 href=#__codelineno-20-182></a><span class=w>            </span><span class=s2>&quot;X-Kong-Upstream-Status&quot;</span>:<span class=w> </span><span class=nb>false</span>
<a id=__codelineno-20-183 name=__codelineno-20-183 href=#__codelineno-20-183></a><span class=w>        </span><span class=o>}</span>,
<a id=__codelineno-20-184 name=__codelineno-20-184 href=#__codelineno-20-184></a><span class=w>        </span><span class=s2>&quot;plugins&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-185 name=__codelineno-20-185 href=#__codelineno-20-185></a><span class=w>            </span><span class=s2>&quot;bundled&quot;</span>
<a id=__codelineno-20-186 name=__codelineno-20-186 href=#__codelineno-20-186></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-187 name=__codelineno-20-187 href=#__codelineno-20-187></a><span class=w>        </span><span class=s2>&quot;ssl_ciphers&quot;</span>:<span class=w> </span><span class=s2>&quot;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256&quot;</span>,
<a id=__codelineno-20-188 name=__codelineno-20-188 href=#__codelineno-20-188></a><span class=w>        </span><span class=s2>&quot;db_resurrect_ttl&quot;</span>:<span class=w> </span><span class=m>30</span>,
<a id=__codelineno-20-189 name=__codelineno-20-189 href=#__codelineno-20-189></a><span class=w>        </span><span class=s2>&quot;nginx_proxy_directives&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-190 name=__codelineno-20-190 href=#__codelineno-20-190></a><span class=w>        </span><span class=s2>&quot;cassandra_consistency&quot;</span>:<span class=w> </span><span class=s2>&quot;ONE&quot;</span>,
<a id=__codelineno-20-191 name=__codelineno-20-191 href=#__codelineno-20-191></a><span class=w>        </span><span class=s2>&quot;client_max_body_size&quot;</span>:<span class=w> </span><span class=s2>&quot;0&quot;</span>,
<a id=__codelineno-20-192 name=__codelineno-20-192 href=#__codelineno-20-192></a><span class=w>        </span><span class=s2>&quot;admin_error_log&quot;</span>:<span class=w> </span><span class=s2>&quot;/dev/stderr&quot;</span>,
<a id=__codelineno-20-193 name=__codelineno-20-193 href=#__codelineno-20-193></a><span class=w>        </span><span class=s2>&quot;pg_ssl_verify&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-194 name=__codelineno-20-194 href=#__codelineno-20-194></a><span class=w>        </span><span class=s2>&quot;dns_not_found_ttl&quot;</span>:<span class=w> </span><span class=m>30</span>,
<a id=__codelineno-20-195 name=__codelineno-20-195 href=#__codelineno-20-195></a><span class=w>        </span><span class=s2>&quot;pg_ssl&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-196 name=__codelineno-20-196 href=#__codelineno-20-196></a><span class=w>        </span><span class=s2>&quot;lua_ssl_verify_depth&quot;</span>:<span class=w> </span><span class=m>1</span>,
<a id=__codelineno-20-197 name=__codelineno-20-197 href=#__codelineno-20-197></a><span class=w>        </span><span class=s2>&quot;ssl_cipher_suite&quot;</span>:<span class=w> </span><span class=s2>&quot;modern&quot;</span>,
<a id=__codelineno-20-198 name=__codelineno-20-198 href=#__codelineno-20-198></a><span class=w>        </span><span class=s2>&quot;cassandra_repl_strategy&quot;</span>:<span class=w> </span><span class=s2>&quot;SimpleStrategy&quot;</span>,
<a id=__codelineno-20-199 name=__codelineno-20-199 href=#__codelineno-20-199></a><span class=w>        </span><span class=s2>&quot;proxy_error_log&quot;</span>:<span class=w> </span><span class=s2>&quot;/dev/stderr&quot;</span>,
<a id=__codelineno-20-200 name=__codelineno-20-200 href=#__codelineno-20-200></a><span class=w>        </span><span class=s2>&quot;kong_env&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/.kong_env&quot;</span>,
<a id=__codelineno-20-201 name=__codelineno-20-201 href=#__codelineno-20-201></a><span class=w>        </span><span class=s2>&quot;db_cache_ttl&quot;</span>:<span class=w> </span><span class=m>0</span>,
<a id=__codelineno-20-202 name=__codelineno-20-202 href=#__codelineno-20-202></a><span class=w>        </span><span class=s2>&quot;pg_max_concurrent_queries&quot;</span>:<span class=w> </span><span class=m>0</span>,
<a id=__codelineno-20-203 name=__codelineno-20-203 href=#__codelineno-20-203></a><span class=w>        </span><span class=s2>&quot;nginx_kong_conf&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/nginx-kong.conf&quot;</span>,
<a id=__codelineno-20-204 name=__codelineno-20-204 href=#__codelineno-20-204></a><span class=w>        </span><span class=s2>&quot;cassandra_schema_consensus_timeout&quot;</span>:<span class=w> </span><span class=m>10000</span>,
<a id=__codelineno-20-205 name=__codelineno-20-205 href=#__codelineno-20-205></a><span class=w>        </span><span class=s2>&quot;dns_hostsfile&quot;</span>:<span class=w> </span><span class=s2>&quot;/etc/hosts&quot;</span>,
<a id=__codelineno-20-206 name=__codelineno-20-206 href=#__codelineno-20-206></a><span class=w>        </span><span class=s2>&quot;admin_listeners&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-207 name=__codelineno-20-207 href=#__codelineno-20-207></a><span class=w>            </span><span class=o>{</span>
<a id=__codelineno-20-208 name=__codelineno-20-208 href=#__codelineno-20-208></a><span class=w>                </span><span class=s2>&quot;transparent&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-209 name=__codelineno-20-209 href=#__codelineno-20-209></a><span class=w>                </span><span class=s2>&quot;ssl&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-210 name=__codelineno-20-210 href=#__codelineno-20-210></a><span class=w>                </span><span class=s2>&quot;ip&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0&quot;</span>,
<a id=__codelineno-20-211 name=__codelineno-20-211 href=#__codelineno-20-211></a><span class=w>                </span><span class=s2>&quot;proxy_protocol&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-212 name=__codelineno-20-212 href=#__codelineno-20-212></a><span class=w>                </span><span class=s2>&quot;port&quot;</span>:<span class=w> </span><span class=m>8444</span>,
<a id=__codelineno-20-213 name=__codelineno-20-213 href=#__codelineno-20-213></a><span class=w>                </span><span class=s2>&quot;http2&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-214 name=__codelineno-20-214 href=#__codelineno-20-214></a><span class=w>                </span><span class=s2>&quot;listener&quot;</span>:<span class=w> </span><span class=s2>&quot;0.0.0.0:8444 ssl&quot;</span>
<a id=__codelineno-20-215 name=__codelineno-20-215 href=#__codelineno-20-215></a><span class=w>            </span><span class=o>}</span>
<a id=__codelineno-20-216 name=__codelineno-20-216 href=#__codelineno-20-216></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-217 name=__codelineno-20-217 href=#__codelineno-20-217></a><span class=w>        </span><span class=s2>&quot;dns_stale_ttl&quot;</span>:<span class=w> </span><span class=m>4</span>,
<a id=__codelineno-20-218 name=__codelineno-20-218 href=#__codelineno-20-218></a><span class=w>        </span><span class=s2>&quot;ssl_cert&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.crt&quot;</span>,
<a id=__codelineno-20-219 name=__codelineno-20-219 href=#__codelineno-20-219></a><span class=w>        </span><span class=s2>&quot;cassandra_timeout&quot;</span>:<span class=w> </span><span class=m>5000</span>,
<a id=__codelineno-20-220 name=__codelineno-20-220 href=#__codelineno-20-220></a><span class=w>        </span><span class=s2>&quot;admin_ssl_cert_key_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/admin-kong-default.key&quot;</span>,
<a id=__codelineno-20-221 name=__codelineno-20-221 href=#__codelineno-20-221></a><span class=w>        </span><span class=s2>&quot;cassandra_ssl_verify&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-20-222 name=__codelineno-20-222 href=#__codelineno-20-222></a><span class=w>        </span><span class=s2>&quot;mem_cache_size&quot;</span>:<span class=w> </span><span class=s2>&quot;128m&quot;</span>,
<a id=__codelineno-20-223 name=__codelineno-20-223 href=#__codelineno-20-223></a><span class=w>        </span><span class=s2>&quot;log_level&quot;</span>:<span class=w> </span><span class=s2>&quot;notice&quot;</span>,
<a id=__codelineno-20-224 name=__codelineno-20-224 href=#__codelineno-20-224></a><span class=w>        </span><span class=s2>&quot;real_ip_recursive&quot;</span>:<span class=w> </span><span class=s2>&quot;off&quot;</span>,
<a id=__codelineno-20-225 name=__codelineno-20-225 href=#__codelineno-20-225></a><span class=w>        </span><span class=s2>&quot;cassandra_repl_factor&quot;</span>:<span class=w> </span><span class=m>1</span>,
<a id=__codelineno-20-226 name=__codelineno-20-226 href=#__codelineno-20-226></a><span class=w>        </span><span class=s2>&quot;client_ssl_cert_key_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.key&quot;</span>,
<a id=__codelineno-20-227 name=__codelineno-20-227 href=#__codelineno-20-227></a><span class=w>        </span><span class=s2>&quot;nginx_daemon&quot;</span>:<span class=w> </span><span class=s2>&quot;off&quot;</span>,
<a id=__codelineno-20-228 name=__codelineno-20-228 href=#__codelineno-20-228></a><span class=w>        </span><span class=s2>&quot;anonymous_reports&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-229 name=__codelineno-20-229 href=#__codelineno-20-229></a><span class=w>        </span><span class=s2>&quot;nginx_sproxy_directives&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-230 name=__codelineno-20-230 href=#__codelineno-20-230></a><span class=w>        </span><span class=s2>&quot;nginx_stream_directives&quot;</span>:<span class=w> </span><span class=o>{}</span>,
<a id=__codelineno-20-231 name=__codelineno-20-231 href=#__codelineno-20-231></a><span class=w>        </span><span class=s2>&quot;pg_port&quot;</span>:<span class=w> </span><span class=m>5432</span>,
<a id=__codelineno-20-232 name=__codelineno-20-232 href=#__codelineno-20-232></a><span class=w>        </span><span class=s2>&quot;nginx_kong_stream_conf&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/nginx-kong-stream.conf&quot;</span>,
<a id=__codelineno-20-233 name=__codelineno-20-233 href=#__codelineno-20-233></a><span class=w>        </span><span class=s2>&quot;client_body_buffer_size&quot;</span>:<span class=w> </span><span class=s2>&quot;8k&quot;</span>,
<a id=__codelineno-20-234 name=__codelineno-20-234 href=#__codelineno-20-234></a><span class=w>        </span><span class=s2>&quot;ssl_preread_enabled&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-20-235 name=__codelineno-20-235 href=#__codelineno-20-235></a><span class=w>        </span><span class=s2>&quot;ssl_cert_csr_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.csr&quot;</span>,
<a id=__codelineno-20-236 name=__codelineno-20-236 href=#__codelineno-20-236></a><span class=w>        </span><span class=s2>&quot;cassandra_contact_points&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-20-237 name=__codelineno-20-237 href=#__codelineno-20-237></a><span class=w>            </span><span class=s2>&quot;127.0.0.1&quot;</span>
<a id=__codelineno-20-238 name=__codelineno-20-238 href=#__codelineno-20-238></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-20-239 name=__codelineno-20-239 href=#__codelineno-20-239></a><span class=w>        </span><span class=s2>&quot;cassandra_keyspace&quot;</span>:<span class=w> </span><span class=s2>&quot;kong&quot;</span>,
<a id=__codelineno-20-240 name=__codelineno-20-240 href=#__codelineno-20-240></a><span class=w>        </span><span class=s2>&quot;ssl_cert_default&quot;</span>:<span class=w> </span><span class=s2>&quot;/usr/local/kong/ssl/kong-default.crt&quot;</span>,
<a id=__codelineno-20-241 name=__codelineno-20-241 href=#__codelineno-20-241></a><span class=w>        </span><span class=s2>&quot;lua_socket_pool_size&quot;</span>:<span class=w> </span><span class=m>30</span>,
<a id=__codelineno-20-242 name=__codelineno-20-242 href=#__codelineno-20-242></a><span class=w>        </span><span class=s2>&quot;admin_ssl_enabled&quot;</span>:<span class=w> </span><span class=nb>true</span>
<a id=__codelineno-20-243 name=__codelineno-20-243 href=#__codelineno-20-243></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-20-244 name=__codelineno-20-244 href=#__codelineno-20-244></a><span class=w>    </span><span class=s2>&quot;version&quot;</span>:<span class=w> </span><span class=s2>&quot;1.2.2&quot;</span>,
<a id=__codelineno-20-245 name=__codelineno-20-245 href=#__codelineno-20-245></a><span class=w>    </span><span class=s2>&quot;node_id&quot;</span>:<span class=w> </span><span class=s2>&quot;cc0f6fa7-3c2c-44f8-a523-8f9e53d7e41e&quot;</span>,
<a id=__codelineno-20-246 name=__codelineno-20-246 href=#__codelineno-20-246></a><span class=w>    </span><span class=s2>&quot;lua_version&quot;</span>:<span class=w> </span><span class=s2>&quot;LuaJIT 2.1.0-beta3&quot;</span>,
<a id=__codelineno-20-247 name=__codelineno-20-247 href=#__codelineno-20-247></a><span class=w>    </span><span class=s2>&quot;prng_seeds&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-248 name=__codelineno-20-248 href=#__codelineno-20-248></a><span class=w>        </span><span class=s2>&quot;pid: 36&quot;</span>:<span class=w> </span><span class=m>195221171165</span>,
<a id=__codelineno-20-249 name=__codelineno-20-249 href=#__codelineno-20-249></a><span class=w>        </span><span class=s2>&quot;pid: 35&quot;</span>:<span class=w> </span><span class=m>148625059221</span>,
<a id=__codelineno-20-250 name=__codelineno-20-250 href=#__codelineno-20-250></a><span class=w>        </span><span class=s2>&quot;pid: 39&quot;</span>:<span class=w> </span><span class=m>191125165965</span>,
<a id=__codelineno-20-251 name=__codelineno-20-251 href=#__codelineno-20-251></a><span class=w>        </span><span class=s2>&quot;pid: 1&quot;</span>:<span class=w> </span><span class=m>173981549072</span>,
<a id=__codelineno-20-252 name=__codelineno-20-252 href=#__codelineno-20-252></a><span class=w>        </span><span class=s2>&quot;pid: 34&quot;</span>:<span class=w> </span><span class=m>137193103112</span>,
<a id=__codelineno-20-253 name=__codelineno-20-253 href=#__codelineno-20-253></a><span class=w>        </span><span class=s2>&quot;pid: 38&quot;</span>:<span class=w> </span><span class=m>175366916141</span>,
<a id=__codelineno-20-254 name=__codelineno-20-254 href=#__codelineno-20-254></a><span class=w>        </span><span class=s2>&quot;pid: 37&quot;</span>:<span class=w> </span><span class=m>192138146579</span>,
<a id=__codelineno-20-255 name=__codelineno-20-255 href=#__codelineno-20-255></a><span class=w>        </span><span class=s2>&quot;pid: 32&quot;</span>:<span class=w> </span><span class=m>214162161921</span>,
<a id=__codelineno-20-256 name=__codelineno-20-256 href=#__codelineno-20-256></a><span class=w>        </span><span class=s2>&quot;pid: 33&quot;</span>:<span class=w> </span><span class=m>152108231211</span>
<a id=__codelineno-20-257 name=__codelineno-20-257 href=#__codelineno-20-257></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-20-258 name=__codelineno-20-258 href=#__codelineno-20-258></a><span class=w>    </span><span class=s2>&quot;timers&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-20-259 name=__codelineno-20-259 href=#__codelineno-20-259></a><span class=w>        </span><span class=s2>&quot;pending&quot;</span>:<span class=w> </span><span class=m>6</span>,
<a id=__codelineno-20-260 name=__codelineno-20-260 href=#__codelineno-20-260></a><span class=w>        </span><span class=s2>&quot;running&quot;</span>:<span class=w> </span><span class=m>0</span>
<a id=__codelineno-20-261 name=__codelineno-20-261 href=#__codelineno-20-261></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-20-262 name=__codelineno-20-262 href=#__codelineno-20-262></a><span class=w>    </span><span class=s2>&quot;hostname&quot;</span>:<span class=w> </span><span class=s2>&quot;api-gateway-kong-79f697ff7c-bcr7m&quot;</span>
<a id=__codelineno-20-263 name=__codelineno-20-263 href=#__codelineno-20-263></a><span class=o>}</span>
</code></pre></div> <ul> <li>curl 创建一个service</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>curl<span class=w> </span>-i<span class=w> </span>-k<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>--url<span class=w> </span>https://10.234.2.204:30840/services/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>--data<span class=w> </span><span class=s1>&#39;name=baidu-service&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>--data<span class=w> </span><span class=s1>&#39;url=https://www.baidu.com/&#39;</span>
</code></pre></div> <ul> <li>创建一个routes</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>curl<span class=w> </span>-ik<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>--url<span class=w> </span>https://10.234.2.204:30840/services/baidu-service/routes<span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>--data<span class=w> </span><span class=s1>&#39;hosts[]=baidu.com&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>--data<span class=w> </span><span class=s1>&#39;paths[]=/api/baidu&#39;</span>
</code></pre></div> <ul> <li>curl测试</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1>#访问proxy</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>curl<span class=w> </span>-k<span class=w> </span>http://10.234.2.204:32582/api/baidu<span class=w> </span>--header<span class=w> </span><span class=s1>&#39;Host: baidu.com&#39;</span>
</code></pre></div> <p><img alt=image-20190817160750967 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817160750967.png"></p> <h1 id=_6>六 使用<a class=headerlink href=#_6 title="Permanent link">&para;</a></h1> <h2 id=61-cli>6.1 CLI使用<a class=headerlink href=#61-cli title="Permanent link">&para;</a></h2> <p>提供的CLI（命令行界面Command Line Interface）允许启动，停止和管理Kong实例。CLI可以管理本地节点（如在当前计算机上）。</p> <ul> <li>通用参数</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>--help：打印此命令的帮助信息
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>--v：启用详细模式
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>--vv：启用调试模式（很多输出）
</code></pre></div> <ul> <li>命令</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a>kong<span class=w> </span>check<span class=w> </span>&lt;conf&gt;<span class=w>       </span><span class=c1>#检查给定Kong配置文件的有效性。</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>kong<span class=w> </span>health<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span><span class=w>   </span><span class=c1>#验证Kong 的服务组件是否正常运行</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>kong<span class=w> </span>migrations<span class=w> </span>COMMAND<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>可用的命令如下：
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=w>  </span>bootstrap<span class=w>                         </span>引导数据库并运行全部迁移（初始化）。
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>  </span>up<span class=w>                                </span>运行新迁移。
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=w>  </span>finish<span class=w>                            </span>完成正在等待中的迁移命令，在执行<span class=sb>`</span>up<span class=sb>`</span>后。
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=w>  </span>list<span class=w>                              </span>列出已执行的迁移。
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>  </span>reset<span class=w>                             </span>重置数据库。
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>Options（可选）:
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w> </span>-y,--yes<span class=w>                           </span>假设提示“yes”，并运行非交互模式
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w> </span>-q,--quiet<span class=w>                         </span>忽略所有输出
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w> </span>-f,--force<span class=w>                         </span>依旧执行迁移，即使数据库报告已经执行过了。
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w> </span>--db-timeout<span class=w>     </span><span class=o>(</span>default<span class=w> </span><span class=m>60</span><span class=o>)</span><span class=w>      </span>超时时间，以秒为单位，所有数据库操作通用（包括Cassandra的schema<span class=w> </span>consensus）。
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w> </span>--lock-timeout<span class=w>   </span><span class=o>(</span>default<span class=w> </span><span class=m>60</span><span class=o>)</span><span class=w>      </span>超时时间，以秒为单位,<span class=w> </span>节点等待领导节点迁移完成。
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w> </span>-c,--conf<span class=w>        </span><span class=o>(</span>optional<span class=w> </span>string<span class=o>)</span><span class=w> </span>配置文件。
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>kong<span class=w> </span>quit<span class=w>   </span><span class=o>[</span>OPTIONS<span class=o>]</span><span class=w>   </span><span class=c1>#优雅地退出一个正在运行的Kong节点（Nginx和其他节点）在给定的前缀目录中配置的服务。</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>kong<span class=w> </span>reload<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span><span class=w>   </span><span class=c1>#重新加载Kong节点（并启动其他已配置的服务）在给定的前缀目录中。</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>kong<span class=w> </span>restart<span class=w> </span><span class=o>[</span>OPTIONS<span class=o>]</span><span class=w>  </span><span class=c1>#重新启动Kong节点（以及其他配置的服务，如Serf）在给定的前缀目录中。</span>
</code></pre></div> <p>更详细的CLI参数可参考：<a href=https://docs.konghq.com/1.1.x/cli/ >CLI Reference</a></p> <h2 id=61>6.1 配置一个实例<a class=headerlink href=#61 title="Permanent link">&para;</a></h2> <p>配置一个访问 <a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.baidu.com%2F">www.baidu.com/</a> 的接口API，实际使用时会对接后端的业务数据接口地址。</p> <p>路由定义了匹配客户端请求的规则，每一个路由关联一个 Service，每一个 Service 有可能被多个路由关联，每一个匹配到指定的路由请求将被代理到它关联的 Service 上,参见<a href=https://docs.konghq.com/0.14.x/admin-api/#route-object>Kong Admin Api Route Object</a>。</p> <p>kong admin接口</p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a>GET<span class=w> </span>/routers/<span class=w>                                </span><span class=c1>#列出所有路由</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>GET<span class=w> </span>/services/<span class=w>                               </span><span class=c1>#列出所有服务</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>GET<span class=w> </span>/consumers/<span class=w>                              </span><span class=c1>#列出所有用户</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>GET<span class=w> </span>/services/<span class=o>{</span>service<span class=w> </span>name<span class=w> </span>or<span class=w> </span>id<span class=o>}</span>/routes<span class=w>    </span><span class=c1>#列出服务关联的路由</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>GET<span class=w> </span>/plugins/<span class=w>                                </span><span class=c1>#列出所有的插件配置</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>GET<span class=w> </span>/plugins/enabled<span class=w>                         </span><span class=c1>#列出所有可以使用的插件</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>GET<span class=w> </span>/plugins/schema/<span class=o>{</span>plugin<span class=w> </span>name<span class=o>}</span><span class=w>            </span><span class=c1>#获得插件的配置模版</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>GET<span class=w> </span>/certificates/<span class=w>                           </span><span class=c1>#列出所有的证书</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>GET<span class=w> </span>/snis/<span class=w>                                   </span><span class=c1>#列出所有域名与证书的对应</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>GET<span class=w> </span>/upstreams/<span class=w>                              </span><span class=c1>#列出所有的upstream</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>GET<span class=w> </span>/upstreams/<span class=o>{</span>name<span class=w> </span>or<span class=w> </span>id<span class=o>}</span>/health/<span class=w>          </span><span class=c1>#查看upstream的健康状态</span>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>GET<span class=w> </span>/upstreams/<span class=o>{</span>name<span class=w> </span>or<span class=w> </span>id<span class=o>}</span>/targets/all<span class=w>      </span><span class=c1>#列出upstream中所有的target</span>
</code></pre></div> <h3 id=611>6.1.1 创建服务<a class=headerlink href=#611 title="Permanent link">&para;</a></h3> <p>服务是上游服务的抽象，可以是一个应用，或者具体某个接口。</p> <ul> <li>命令行方式创建服务：</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>--url<span class=w> </span>http://134.175.74.48:8001/services/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>--data<span class=w> </span><span class=s1>&#39;name=baidu-service&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a>--data<span class=w> </span><span class=s1>&#39;url=https://www.baidu.com/&#39;</span>
</code></pre></div> <ul> <li>postman创建</li> </ul> <p><img alt=image-20190817133710764 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817133710764.png"></p> <p><img alt=image-20190817133745018 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817133745018.png"></p> <h3 id=612>6.1.2 创建路由<a class=headerlink href=#612 title="Permanent link">&para;</a></h3> <p>在刚才创建的baidu-service的服务上创建路由</p> <ul> <li>Curl 创建</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>--url<span class=w> </span>http://134.175.74.48:8001/services/baidu-service/routes<span class=w> </span><span class=se>\</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>--data<span class=w> </span><span class=s1>&#39;hosts[]=baidu.com&#39;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a>--data<span class=w> </span><span class=s1>&#39;paths[]=/api/baidu&#39;</span>
</code></pre></div> <ul> <li>postman创建</li> </ul> <p><img alt=image-20190817134532656 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817134532656.png"></p> <p><img alt=image-20190817134549048 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817134549048.png"></p> <h3 id=613>6.1.3 测试<a class=headerlink href=#613 title="Permanent link">&para;</a></h3> <ul> <li>curl测试</li> </ul> <p>这时候访问kong的<code>proxy地址</code>时，如果host为baidu.com<code>，请求被转发到</code><a href=http://baidu.com>http://baidu.com</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>curl<span class=w>  </span>http://134.175.74.48:8000/api/baidu<span class=w> </span>--header<span class=w> </span><span class=s1>&#39;Host: baidu.com&#39;</span>
</code></pre></div> <ul> <li>postman测试</li> </ul> <p><img alt=image-20190817135916450 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817135916450.png"></p> <p>测试post</p> <p><img alt=image-20190817141040054 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817141040054.png"></p> <p>利用konga web界面操作更为方便。</p> <h2 id=62>6.2 插件使用<a class=headerlink href=#62 title="Permanent link">&para;</a></h2> <p>插件是用来扩展API的，例如为API添加认证、设置ACL、限制速率等、集成oauth、ldap等。</p> <h3 id=621-jwt>6.2.1 认证-JWT<a class=headerlink href=#621-jwt title="Permanent link">&para;</a></h3> <p>上面的配置，只要知道Router的地址，就可以访问获取数据，我们要把API加入身份认证。如果API面对不是具体用户，而是其他的系统，可以使用JWT来进行系统间身份认证，使用Kong JWT插件就可能完成这功能。JWT 插件要在对应的Router上进行启用。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>curl<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span>http://134.175.74.48:8001/routes/8e6a1982-5dee-492c-8fe0-c046ebae573c/plugins<span class=w> </span><span class=se>\</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=w>    </span>--data<span class=w> </span><span class=s2>&quot;name=jwt&quot;</span>
</code></pre></div> <p>fee36521-e549-410f-8986-9fbba02219c1 是创建的service的ID。</p> <p>这时再通过Postman 访问上面的接口就会提示：</p> <p><img alt=image-20190817142716105 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817142716105.png"></p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=o>{</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=w>    </span><span class=s2>&quot;message&quot;</span>:<span class=w> </span><span class=s2>&quot;Unauthorized&quot;</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=o>}</span>
</code></pre></div> <ul> <li>创建用户</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>--url<span class=w> </span>http://134.175.74.48:8001/consumers/<span class=w>  </span><span class=se>\</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>--data<span class=w> </span><span class=s2>&quot;username=kongauser1&quot;</span>
</code></pre></div> <ul> <li>用户生成JWT凭证</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>--url<span class=w> </span>http://134.175.74.48:8001/consumers/kongauser1/jwt<span class=w> </span><span class=se>\</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>--header<span class=w> </span><span class=s2>&quot;Content-Type: application/x-www-form-urlencoded&quot;</span>
</code></pre></div> <p>返回凭证信息，也可以通过 get 方法查询凭证信息</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=o>{</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=w>    </span><span class=s2>&quot;rsa_public_key&quot;</span>:<span class=w> </span>null,
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=w>    </span><span class=s2>&quot;created_at&quot;</span>:<span class=w> </span><span class=m>1560723665</span>,
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a><span class=w>    </span><span class=s2>&quot;consumer&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=w>        </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=s2>&quot;8bb94f49-22a6-4d77-9a64-21f13adc0342&quot;</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=w>    </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=s2>&quot;a110d234-6dc1-4443-9da2-21acddc66e09&quot;</span>,
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a><span class=w>    </span><span class=s2>&quot;algorithm&quot;</span>:<span class=w> </span><span class=s2>&quot;HS256&quot;</span>,
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=w>    </span><span class=s2>&quot;secret&quot;</span>:<span class=w> </span><span class=s2>&quot;lCe8Lbb7F0KtLccaBcBnOvYg76V7wmQx&quot;</span>,
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a><span class=w>    </span><span class=s2>&quot;key&quot;</span>:<span class=w> </span><span class=s2>&quot;7yQoUdF0aFUC9N593uLQLbqL7RSPj2qM&quot;</span>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=o>}</span>
</code></pre></div> <p><img alt=image-20190817143334116 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817143334116.png"></p> <p>使用key和secret在 <a href="https://link.juejin.im/?target=https%3A%2F%2Fjwt.io%2F">jwt.io/</a> 可以生成jwt 凭证信息.</p> <p><img alt=image-20190817144844418 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817144844418.png"></p> <p><img alt=image-20190817145045869 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817145045869.png"></p> <p>再通过postman 访问，就可以看到数据了。</p> <h3 id=622-acl>6.2.2 安全-ACL<a class=headerlink href=#622-acl title="Permanent link">&para;</a></h3> <p>JWT插件可以保护API能够被受信用户访问，但不能区别哪个用户能够访问哪个API，即接口权限问题，我们使用ACL 插件解决这个问题.</p> <p>在上面定义好的路由上启用acl 插件，指定白名单，</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>--url<span class=w> </span>http://134.175.74.48:8001/routes/afb8bfbd-977e-464f-8c94-05d6c5c98429/plugins<span class=w> </span><span class=se>\</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a>--data<span class=w> </span><span class=s2>&quot;name=acl&quot;</span><span class=w>  </span><span class=se>\</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>--data<span class=w> </span><span class=s2>&quot;config.whitelist=go2cloud-api-group&quot;</span>
</code></pre></div> <p>此时再访问api，会提示不能访问这个服务。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=o>{</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=w>    </span><span class=s2>&quot;message&quot;</span>:<span class=w> </span><span class=s2>&quot;You cannot consume this service&quot;</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=o>}</span>
</code></pre></div> <p><img alt=image-20190817145611678 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817145611678.png"></p> <p>只需将kongauser1这个用户关联到白名单内的go2cloud-api-group组里即可。</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>--url<span class=w> </span>http://134.175.74.48:8001/consumers/tianqiuser/acls<span class=w> </span><span class=se>\</span>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>--data<span class=w> </span><span class=s2>&quot;group=tianqi&quot;</span>
</code></pre></div> <p><img alt=image-20190817150114223 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817150114223.png"></p> <p>再次访问接口，能正常返回数据。</p> <p><img alt=image-20190817150129536 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817150129536.png"></p> <p>现在就可以对网关暴露的接口进行身份认证和权限控制了。</p> <h3 id=623-key-auth>6.2.3 认证-key-auth<a class=headerlink href=#623-key-auth title="Permanent link">&para;</a></h3> <ul> <li>为服务或者路由创建key-auth，插件即可以应用在service上，也可以应用在route上</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=w> </span>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=w>  </span>--url<span class=w> </span>http://134.175.74.48:8001/services/go2cloud-api/plugins/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=w>  </span>--data<span class=w> </span><span class=s1>&#39;name=key-auth&#39;</span>
</code></pre></div> <p><img alt=image-20190817153938169 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817153938169.png"></p> <p>获取到的结果为：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=o>{</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=w>    </span><span class=s2>&quot;created_at&quot;</span>:<span class=w> </span><span class=m>1566027525</span>,
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=w>    </span><span class=s2>&quot;config&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=w>        </span><span class=s2>&quot;key_names&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=w>            </span><span class=s2>&quot;apikey&quot;</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=w>        </span><span class=o>]</span>,
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=w>        </span><span class=s2>&quot;run_on_preflight&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=w>        </span><span class=s2>&quot;anonymous&quot;</span>:<span class=w> </span>null,
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a><span class=w>        </span><span class=s2>&quot;hide_credentials&quot;</span>:<span class=w> </span>false,
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a><span class=w>        </span><span class=s2>&quot;key_in_body&quot;</span>:<span class=w> </span><span class=nb>false</span>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a><span class=w>    </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=s2>&quot;9be2def2-df65-41a4-97b7-52e44b207427&quot;</span>,
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=w>    </span><span class=s2>&quot;service&quot;</span>:<span class=w> </span><span class=o>{</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a><span class=w>        </span><span class=s2>&quot;id&quot;</span>:<span class=w> </span><span class=s2>&quot;ceb337a3-a6e0-4520-ba7a-f61403e36dcf&quot;</span>
<a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a><span class=w>    </span><span class=o>}</span>,
<a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a><span class=w>    </span><span class=s2>&quot;name&quot;</span>:<span class=w> </span><span class=s2>&quot;key-auth&quot;</span>,
<a id=__codelineno-41-17 name=__codelineno-41-17 href=#__codelineno-41-17></a><span class=w>    </span><span class=s2>&quot;protocols&quot;</span>:<span class=w> </span><span class=o>[</span>
<a id=__codelineno-41-18 name=__codelineno-41-18 href=#__codelineno-41-18></a><span class=w>        </span><span class=s2>&quot;grpc&quot;</span>,
<a id=__codelineno-41-19 name=__codelineno-41-19 href=#__codelineno-41-19></a><span class=w>        </span><span class=s2>&quot;grpcs&quot;</span>,
<a id=__codelineno-41-20 name=__codelineno-41-20 href=#__codelineno-41-20></a><span class=w>        </span><span class=s2>&quot;http&quot;</span>,
<a id=__codelineno-41-21 name=__codelineno-41-21 href=#__codelineno-41-21></a><span class=w>        </span><span class=s2>&quot;https&quot;</span>
<a id=__codelineno-41-22 name=__codelineno-41-22 href=#__codelineno-41-22></a><span class=w>    </span><span class=o>]</span>,
<a id=__codelineno-41-23 name=__codelineno-41-23 href=#__codelineno-41-23></a><span class=w>    </span><span class=s2>&quot;enabled&quot;</span>:<span class=w> </span>true,
<a id=__codelineno-41-24 name=__codelineno-41-24 href=#__codelineno-41-24></a><span class=w>    </span><span class=s2>&quot;run_on&quot;</span>:<span class=w> </span><span class=s2>&quot;first&quot;</span>,
<a id=__codelineno-41-25 name=__codelineno-41-25 href=#__codelineno-41-25></a><span class=w>    </span><span class=s2>&quot;consumer&quot;</span>:<span class=w> </span>null,
<a id=__codelineno-41-26 name=__codelineno-41-26 href=#__codelineno-41-26></a><span class=w>    </span><span class=s2>&quot;route&quot;</span>:<span class=w> </span>null,
<a id=__codelineno-41-27 name=__codelineno-41-27 href=#__codelineno-41-27></a><span class=w>    </span><span class=s2>&quot;tags&quot;</span>:<span class=w> </span>null
<a id=__codelineno-41-28 name=__codelineno-41-28 href=#__codelineno-41-28></a><span class=o>}</span>
</code></pre></div> <ul> <li>创建用户，在用户中配置apk-key</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=w>  </span>--url<span class=w> </span>http://localhost:8001/consumers/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=w>  </span>--data<span class=w> </span><span class=s2>&quot;username=Jason&quot;</span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>
<a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a>curl<span class=w> </span>-i<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
<a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=w>  </span>--url<span class=w> </span>http://localhost:8001/consumers/Jason/key-auth/<span class=w> </span><span class=se>\</span>
<a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=w>  </span>--data<span class=w> </span><span class=s1>&#39;key=123456&#39;</span>
</code></pre></div> <p><img alt=image-20190817154432989 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817154432989.png"></p> <ul> <li>postman测试，认证方式为apikey</li> </ul> <p><img alt=image-20190817154601679 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190817154601679.png"></p> <p><a href=https://docs.konghq.com/hub/ >https://docs.konghq.com/hub/</a>)</p> <h3 id=624-basic-auth>6.2.4 认证-basic auth<a class=headerlink href=#624-basic-auth title="Permanent link">&para;</a></h3> <ul> <li>在service或route上创建basic auth</li> </ul> <p><img alt=image-20190820152215700 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152215700.png"></p> <ul> <li>在consumers中创建basic credentials</li> </ul> <p><img alt=image-20190820152306471 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152306471.png"></p> <ul> <li>利用postman测试</li> </ul> <p><img alt=image-20190820152511727 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152511727.png"></p> <h3 id=625-ip-restriction>6.2.5 安全-ip-restriction<a class=headerlink href=#625-ip-restriction title="Permanent link">&para;</a></h3> <p>顾名思义，用来设置接口IP的黑白名单</p> <ul> <li>在service或routes上创建basic auth,配置黑白名单</li> </ul> <p><img alt=image-20190820152824293 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152824293.png"></p> <p><img alt=image-20190820152853184 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152853184.png"></p> <ul> <li>postman测试</li> </ul> <p><img alt=image-20190820152935758 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820152935758.png"></p> <p>将调用方的IP地址加入到白名单中，可以正常访问。</p> <h3 id=626-bot-detection>6.2.6 安全-bot-detection<a class=headerlink href=#626-bot-detection title="Permanent link">&para;</a></h3> <ul> <li>为routes或service 创建bot-detection，'User-Agent: PostmanRuntime/7.15.2'，将postman客户端加入到黑名单进行测试，默认规则详见：<a href=https://github.com/Kong/kong/blob/master/kong/plugins/bot-detection/rules.lua>https://github.com/Kong/kong/blob/master/kong/plugins/bot-detection/rules.lua</a></li> </ul> <p><img alt=image-20190820154922845 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820154922845.png"></p> <p><img alt=image-20190820155049894 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820155049894.png"></p> <h3 id=627-rate-limiting>6.2.7 流控-rate-limiting<a class=headerlink href=#627-rate-limiting title="Permanent link">&para;</a></h3> <ul> <li>在service或route配置流量控制</li> </ul> <p>定义每秒/分钟/小时/天/月/年可以发送的请求数量</p> <p>限制可以根据服务或路由/ip地址/证书</p> <p>策略可以利用本地，集群或redis</p> <p>例如配置限制每天只能调用10次</p> <ul> <li>postman测试</li> </ul> <p><img alt=image-20190820160258822 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820160258822.png"></p> <h3 id=628-requestsize-limitingtermination>6.2.8 流控-request/size-limiting/termination<a class=headerlink href=#628-requestsize-limitingtermination title="Permanent link">&para;</a></h3> <p>request-size-limiting 请求payload size限制</p> <p>request-termination 这允许（暂时）阻止API或消费者</p> <p><img alt=image-20190820164356218 src="/Users/xuel/Library/Application Support/typora-user-images/image-20190820164356218.png"></p> <p>此处只简单列举几个插件，更详细的插件请查看：</p> <h1 id=_7>参考链接<a class=headerlink href=#_7 title="Permanent link">&para;</a></h1> <ul> <li><a href=https://docs.konghq.com/0.13.x/admin-api/#route-object>https://docs.konghq.com/0.13.x/admin-api/#route-object</a></li> <li><a href=https://www.kubernetes.org.cn/4952.html>https://www.kubernetes.org.cn/4952.html</a></li> <li><a href=https://www.lijiaocn.com/tags/all.html#kong>https://www.lijiaocn.com/tags/all.html#kong</a></li> <li><a href=https://github.com/Kong/kong>https://github.com/Kong/kong</a></li> <li><a href=https://docs.konghq.com/install/kubernetes/ >https://docs.konghq.com/install/kubernetes/</a></li> <li><a href=https://hub.kubeapps.com/charts/stable/kong>https://hub.kubeapps.com/charts/stable/kong</a></li> <li><a href=https://www.cnblogs.com/zhoujie/p/kong5.html>https://www.cnblogs.com/zhoujie/p/kong5.html</a></li> <li> <p><a href=https://www.cnblogs.com/zhoujie/p/kong1.html>https://www.cnblogs.com/zhoujie/p/kong1.html</a></p> </li> <li> <p><a href=https://github.com/PGBI/kong-dashboard>https://github.com/PGBI/kong-dashboard</a></p> </li> <li> <p><a href=https://pantsel.github.io/konga/ >konga官网</a></p> </li> <li> <p><a href=https://github.com/pantsel/konga>konga github</a></p> </li> <li><a href=https://github.com/qianyugang/kong-docs-cn>kong中文地址</a></li> <li><a href=http://www.102no.com/archives/tag/kong教程>http://www.102no.com/archives/tag/kong%E6%95%99%E7%A8%8B</a></li> </ul> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by using our <a href="https://github.com/redhatxl/redhatxl.github.io/issues/new/?title=[Feedback]+%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3-Kong+-+/cloud-native/other/%E5%BE%AE%E6%9C%8D%E5%8A%A1API%E7%BD%91%E5%85%B3-Kong/" target=_blank>feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2016 - 2024 kaliarch </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/redhatxl target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://kaliarch-bucket-1251990360.cos.ap-beijing.myqcloud.com/blog_img/20220125122524.png target=_blank rel=noopener title=kaliarch-bucket-1251990360.cos.ap-beijing.myqcloud.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">同意</button> <label class=md-button for=__settings>管理设定</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../assets/javascripts/bundle.bd41221c.min.js></script> </body> </html>